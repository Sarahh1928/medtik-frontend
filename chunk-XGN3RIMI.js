import{a as It,b as Ft,c as At,d as Vt,e as Tt,f as Nt,g as Bt,h as $t,i as zt,j as Rt,k as jt}from"./chunk-YHZP6DRE.js";import{a as kt}from"./chunk-7GU6Y6RK.js";import{a as wt,b as yt,d as Dt,e as St,f as Et}from"./chunk-OZHLN6UI.js";import{a as bt,b as Ot,c as Pt}from"./chunk-EAVN2IX3.js";import{a as z,d as R}from"./chunk-DYEZBW6N.js";import"./chunk-F5X5MWHG.js";import{b as vt}from"./chunk-OZY4EI32.js";import{a as T,c as N}from"./chunk-EEDQUWWO.js";import{a as st,b as gt}from"./chunk-FNX66O3M.js";import"./chunk-MS4AQ6UA.js";import{a as ft,b as _t,d as ut}from"./chunk-GNF7NEE4.js";import"./chunk-JXSMCY7E.js";import"./chunk-3RK6DDJD.js";import{a as at,b as rt,e as lt,h as mt,i as ct,m as dt,n as pt}from"./chunk-AK7HCWPM.js";import{a as ht,b as Mt}from"./chunk-5D6YPN3T.js";import"./chunk-UJ7VPDOE.js";import{a as xt,b as Ct}from"./chunk-XLI345ZL.js";import"./chunk-SCUZIYM3.js";import"./chunk-HRQB4EEZ.js";import"./chunk-GED64AQA.js";import"./chunk-Z4D3JJEG.js";import{a as B,b as $}from"./chunk-ENKIQ3XX.js";import{A as ot,b as W,d as y,f as J,g as Q,j as U,l as X,n as tt,o as et,r as nt,y as it}from"./chunk-K2DA6FBL.js";import{Y as A,Z as V}from"./chunk-LVPX6TEL.js";import"./chunk-P6PSD35X.js";import{$a as _,Ab as w,Cb as x,Eb as s,Fc as k,Gc as I,Ia as D,La as r,Ob as L,Pa as M,Pc as Y,Qc as Z,Rc as F,Sb as e,Tb as f,Ub as p,Wa as S,a as v,b,bc as E,dc as H,ec as q,fc as K,gc as G,ja as C,ka as h,qb as d,rb as i,sb as t,tb as g,xb as O,yb as P}from"./chunk-WZIMFKHB.js";var Qt=()=>[],Lt=()=>["currency","price"];function Xt(l,a){l&1&&(i(0,"span"),e(1,", "),t())}function te(l,a){if(l&1&&(i(0,"span"),e(1),_(2,Xt,2,0,"span",14),t()),l&2){let n=a.$implicit,o=a.last;r(),p(" ",n),r(),d("ngIf",!o)}}function ee(l,a){l&1&&(i(0,"th",22),e(1,"Currency"),t())}function ne(l,a){if(l&1&&(i(0,"td",23),e(1),t()),l&2){let n=a.$implicit;r(),f(n.currency)}}function ie(l,a){l&1&&(i(0,"th",22),e(1,"Price"),t())}function oe(l,a){if(l&1&&(i(0,"td",23),e(1),H(2,"number"),t()),l&2){let n=a.$implicit;r(),f(K(2,1,n.price,"1.0-2"))}}function ae(l,a){l&1&&g(0,"tr",24)}function re(l,a){l&1&&g(0,"tr",25)}function le(l,a){if(l&1&&(i(0,"div")(1,"h4"),e(2),t(),i(3,"table",15),O(4,16),_(5,ee,2,0,"th",17)(6,ne,2,1,"td",18),P(),O(7,19),_(8,ie,2,0,"th",17)(9,oe,3,4,"td",18),P(),_(10,ae,1,0,"tr",20)(11,re,1,0,"tr",21),t()()),l&2){let n=a.$implicit;r(2),f(n.key),r(),d("dataSource",n.value),r(7),d("matHeaderRowDef",E(4,Lt)),r(),d("matRowDefColumns",E(5,Lt))}}var j=class l{constructor(a,n){this.data=a;this.dialogRef=n;this.doctor=this.data.doctor}doctor;close(){this.dialogRef.close()}get groupedPricing(){let a={};for(let n of this.doctor?.pricing||[])a[n.service]||(a[n.service]=[]),a[n.service].push(n);return a}static \u0275fac=function(n){return new(n||l)(M(Ot),M(bt))};static \u0275cmp=S({type:l,selectors:[["app-view-doctor"]],decls:101,vars:26,consts:[[1,"doctor-dialog"],[1,"header-with-info"],[1,"header-left"],["alt","Doctor Avatar",1,"avatar",3,"src"],[1,"info"],[1,"title"],[3,"color"],[1,"basic-info-grid"],[4,"ngFor","ngForOf"],[1,"content"],[1,"section"],[1,"chips"],[1,"actions"],["mat-flat-button","","color","primary",3,"click"],[4,"ngIf"],["mat-table","",1,"mat-elevation-z2","pricing-table",3,"dataSource"],["matColumnDef","currency"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","price"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(n,o){n&1&&(i(0,"mat-card",0)(1,"div",1)(2,"div",2),g(3,"img",3),i(4,"div",4)(5,"h2"),e(6),t(),i(7,"p",5),e(8),t(),i(9,"mat-chip",6),e(10),t()()(),i(11,"div",7)(12,"div")(13,"mat-icon"),e(14,"mail"),t(),e(15),t(),i(16,"div")(17,"mat-icon"),e(18,"call"),t(),e(19),t(),i(20,"div")(21,"mat-icon"),e(22,"apartment"),t(),e(23),t(),i(24,"div")(25,"mat-icon"),e(26,"badge"),t(),e(27),t(),i(28,"div")(29,"mat-icon"),e(30,"work_history"),t(),e(31),t(),i(32,"div")(33,"mat-icon"),e(34,"language"),t(),_(35,te,3,2,"span",8),t()()(),i(36,"div",9),g(37,"mat-divider"),i(38,"div",10)(39,"h3")(40,"mat-icon"),e(41,"attach_money"),t(),e(42," Pricing"),t(),_(43,le,12,6,"div",8),H(44,"keyvalue"),t(),g(45,"mat-divider"),i(46,"div",10)(47,"h3")(48,"mat-icon"),e(49,"gavel"),t(),e(50," Policies"),t(),i(51,"div",11)(52,"mat-chip"),e(53),t(),i(54,"mat-chip"),e(55),t(),i(56,"mat-chip",6),e(57),t()()(),g(58,"mat-divider"),i(59,"div",10)(60,"h3")(61,"mat-icon"),e(62,"school"),t(),e(63," Education & Bio"),t(),i(64,"p")(65,"strong"),e(66,"Education:"),t(),e(67),t(),i(68,"p")(69,"strong"),e(70,"Certificates:"),t(),e(71),t(),i(72,"p")(73,"strong"),e(74,"Hospitals:"),t(),e(75),t(),i(76,"p")(77,"strong"),e(78,"Bio:"),t(),e(79),t()(),g(80,"mat-divider"),i(81,"div",10)(82,"h3")(83,"mat-icon"),e(84,"event_available"),t(),e(85," Availability"),t(),i(86,"p"),e(87," Chat: "),i(88,"b"),e(89),t(),e(90,", Voice: "),i(91,"b"),e(92),t(),e(93,", Video: "),i(94,"b"),e(95),t()()()(),i(96,"div",12)(97,"button",13),x("click",function(){return o.close()}),i(98,"mat-icon"),e(99,"close"),t(),e(100," Close "),t()()()),n&2&&(r(3),d("src",(o.doctor.avatar==null?null:o.doctor.avatar.url)||"assets/default-avatar.png",D),r(3),f(o.doctor.fullName),r(2),f(o.doctor.title),r(),d("color",o.doctor.status==="ACTIVE"?"primary":"warn"),r(),p(" ",o.doctor.status," "),r(5),p(" ",o.doctor.email),r(4),p(" ",o.doctor.phone),r(4),p(" ",o.doctor.department==null?null:o.doctor.department.name),r(4),p(" License: ",o.doctor.licenseNumber),r(4),p(" ",o.doctor.yearsOfExperience," years exp."),r(4),d("ngForOf",o.doctor.language||E(25,Qt)),r(8),d("ngForOf",q(44,23,o.groupedPricing)),r(10),p("Cancel: ",o.doctor.cancellationPolicy||"N/A"),r(2),p("Reschedule: ",o.doctor.reschedulePolicy||"N/A"),r(),d("color",o.doctor.noShowPolicy?"warn":"accent"),r(),p(" No-show: ",o.doctor.noShowPolicy?"Applies":"Not Applied"," "),r(10),p(" ",(o.doctor.education==null?null:o.doctor.education.join(", "))||"N/A"),r(4),p(" ",(o.doctor.certificates==null?null:o.doctor.certificates.join(", "))||"N/A"),r(4),p(" ",(o.doctor.hospitals==null?null:o.doctor.hospitals.join(", "))||"N/A"),r(4),p(" ",o.doctor.bio||"No bio available."),r(10),f(o.doctor.availability!=null&&o.doctor.availability.chat?"Yes":"No"),r(3),f(o.doctor.availability!=null&&o.doctor.availability.voice?"Yes":"No"),r(3),f(o.doctor.availability!=null&&o.doctor.availability.video?"Yes":"No"))},dependencies:[F,k,I,V,A,$,B,N,T,R,z,Ct,xt,jt,It,At,Bt,Vt,Ft,$t,Tt,Nt,zt,Rt,Z,Y],styles:[".header-with-info[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1.5fr;align-items:start;gap:24px}.header-with-info[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px}.header-with-info[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:150px;height:120px;border-radius:50%;object-fit:cover;border:3px solid #5c7aff;box-shadow:0 0 12px #5c7aff66}.header-with-info[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;color:#fff;margin:0}.header-with-info[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#b0b7c3;font-size:1.05rem;margin:4px 0}.header-with-info[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]{font-size:.9rem;background:#5c7aff;color:#fff}.header-with-info[_ngcontent-%COMP%]   .basic-info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}.header-with-info[_ngcontent-%COMP%]   .basic-info-grid[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 14px;border-radius:8px;background:#121c26;color:#dce3ec;font-size:1rem;border:1px solid rgba(255,255,255,.05)}@media (max-width: 768px){.header-with-info[_ngcontent-%COMP%]{grid-template-columns:1fr;text-align:center}.header-with-info[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]{flex-direction:column}}.doctor-dialog[_ngcontent-%COMP%]{width:95%;max-width:1000px;margin:40px auto;padding:32px;background:#0b1620;border-radius:16px;box-shadow:0 4px 25px #0006;color:#e0e6ed;gap:24px;max-height:90vh;display:flex;flex-direction:column}.doctor-dialog[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{overflow-y:auto;max-height:70vh;padding-right:4px}.doctor-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;justify-content:flex-start;gap:24px}.doctor-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:120px;height:120px;border-radius:50%;object-fit:cover;border:3px solid #5c7aff;box-shadow:0 0 12px #5c7aff66}.doctor-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{flex:1}.doctor-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;color:#fff;margin:0}.doctor-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#b0b7c3;font-size:1.05rem;margin:4px 0}.doctor-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]{font-size:.9rem;background:#5c7aff;color:#fff}.doctor-dialog[_ngcontent-%COMP%]   mat-divider[_ngcontent-%COMP%]{margin:16px 0;background:#ffffff1a}.doctor-dialog[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:1.3rem;color:#5c7aff;font-weight:600;margin-bottom:12px}.doctor-dialog[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:10px}.doctor-dialog[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 14px;border-radius:8px;background:#121c26;color:#dce3ec;font-size:1rem;line-height:1.4;border:1px solid rgba(255,255,255,.05)}.doctor-dialog[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .pricing-table[_ngcontent-%COMP%]{width:100%;margin-top:12px;border-radius:8px;border-collapse:collapse;overflow:hidden}.doctor-dialog[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .pricing-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#1f2b3a;color:#5c7aff;padding:10px 14px;font-weight:600;text-align:left;border-bottom:1px solid rgba(255,255,255,.1)}.doctor-dialog[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .pricing-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 14px;background:#101820;color:#cfd5df;border-bottom:1px solid rgba(255,255,255,.05)}.doctor-dialog[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .pricing-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n)   td[_ngcontent-%COMP%]{background:#131d28}.doctor-dialog[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .pricing-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background:#182433}.doctor-dialog[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .chips[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.doctor-dialog[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .chips[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]{font-size:.95rem;background:#1e2937;color:#e0e6ed}.doctor-dialog[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:6px 0;color:#cfd5df;font-size:1rem;line-height:1.5}.doctor-dialog[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{text-align:right;margin-top:16px}.doctor-dialog[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:8px;padding:10px 20px;font-weight:600;background:#5c7aff;color:#fff;transition:background .3s ease}.doctor-dialog[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#4c68e0}.doctor-dialog[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.doctor-dialog[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#5c7aff66;border-radius:8px}.doctor-dialog[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#5c7aff99}@media (max-width: 768px){.doctor-dialog[_ngcontent-%COMP%]{padding:20px}.doctor-dialog[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{flex-direction:column;align-items:center;text-align:center}}@media (max-height: 600px){.doctor-dialog[_ngcontent-%COMP%]{max-height:80vh}}"]})};function me(l,a){l&1&&(i(0,"mat-error"),e(1,"Name is required"),t())}function ce(l,a){l&1&&(i(0,"mat-error"),e(1,"Min 3 characters"),t())}function de(l,a){if(l&1){let n=w();O(0),i(1,"button",31),x("click",function(m){C(n);let c=s().$implicit,u=s();return m.stopPropagation(),h(u.saveDepartment(c))}),i(2,"mat-icon"),e(3,"save"),t(),e(4," Save "),t(),i(5,"button",32),x("click",function(m){C(n);let c=s(2);return m.stopPropagation(),h(c.cancelEdit())}),i(6,"mat-icon"),e(7,"close"),t(),e(8," Cancel "),t(),P()}}function pe(l,a){if(l&1){let n=w();i(0,"button",31),x("click",function(m){C(n);let c=s().$implicit,u=s();return m.stopPropagation(),h(u.editDepartment(c))}),i(1,"mat-icon"),e(2,"edit"),t(),e(3," Edit "),t(),i(4,"button",33),x("click",function(m){C(n);let c=s().$implicit,u=s();return m.stopPropagation(),h(u.removeDepartment(c))}),i(5,"mat-icon"),e(6,"delete"),t(),e(7," Delete "),t()}}function se(l,a){if(l&1){let n=w();i(0,"form",34),x("ngSubmit",function(){C(n);let m=s().$implicit,c=s();return h(c.saveDepartment(m))}),i(1,"mat-form-field",13)(2,"mat-label"),e(3,"Department name"),t(),g(4,"input",35),t(),i(5,"mat-form-field",13)(6,"mat-label"),e(7,"Description"),t(),g(8,"input",36),t(),i(9,"div",37)(10,"button",18)(11,"mat-icon"),e(12,"save"),t(),e(13," Save "),t(),i(14,"button",38),x("click",function(){C(n);let m=s(2);return h(m.cancelEdit())}),i(15,"mat-icon"),e(16,"close"),t(),e(17," Cancel "),t()()()}if(l&2){let n=s(2);d("formGroup",n.editForm)}}function ge(l,a){if(l&1&&(i(0,"div",46)(1,"mat-icon"),e(2,"star"),t(),i(3,"span",48),e(4),t()()),l&2){let n=s().$implicit;r(4),p("",n.rating,"/5")}}function fe(l,a){if(l&1){let n=w();i(0,"mat-card",41)(1,"div",42)(2,"div",43),e(3),t(),i(4,"mat-chip",44),e(5),t()(),i(6,"div",45)(7,"div",46)(8,"mat-icon"),e(9,"mail"),t(),i(10,"a",47),e(11),t()(),i(12,"div",46)(13,"mat-icon"),e(14,"history"),t(),i(15,"span",48),e(16),t()(),_(17,ge,5,1,"div",49),t(),i(18,"div",50)(19,"button",32),x("click",function(){let m=C(n).$implicit,c=s(3);return h(c.viewDoctor(m))}),i(20,"mat-icon"),e(21,"visibility"),t(),e(22," View "),t(),i(23,"button",51),x("click",function(){let m=C(n).$implicit,c=s(2).$implicit,u=s();return h(u.toggleDoctor(c,m))}),i(24,"mat-icon"),e(25),t(),e(26),t()()()}if(l&2){let n=a.$implicit;r(3),f(n.name),r(),d("color",n.status==="active"?"primary":"warn"),r(),f(n.status),r(5),d("href","mailto:"+n.email,D),r(),f(n.email),r(5),p("",n.sessions||0," sessions"),r(),d("ngIf",n.rating),r(6),d("color",n.status==="active"?"warn":"primary"),r(2),f(n.status==="active"?"toggle_off":"toggle_on"),r(),p(" ",n.status==="active"?"Deactivate":"Activate"," ")}}function _e(l,a){if(l&1&&(i(0,"section",39),_(1,fe,27,10,"mat-card",40),t()),l&2){let n=s().$implicit;r(),d("ngForOf",n.doctors)}}function ue(l,a){l&1&&(i(0,"div",52)(1,"mat-icon"),e(2,"group_off"),t(),i(3,"span"),e(4,"No doctors in this department yet."),t()())}function xe(l,a){if(l&1&&(i(0,"mat-expansion-panel",21)(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"div",22)(4,"div",23)(5,"mat-icon",24),e(6,"apartment"),t(),i(7,"span",25),e(8),t()(),i(9,"div",26)(10,"mat-chip",27),e(11," Doctors "),t(),_(12,de,9,0,"ng-container",28)(13,pe,8,0,"ng-template",null,0,G),t()()()(),_(15,se,18,1,"form",29)(16,_e,2,1,"section",30)(17,ue,5,0,"ng-template",null,1,G),t()),l&2){let n=a.$implicit,o=L(14),m=L(18),c=s();r(8),f(n.name),r(2),d("matBadge",n.doctors==null?null:n.doctors.length),r(2),d("ngIf",c.editingId===n.id)("ngIfElse",o),r(3),d("ngIf",c.editingId===n.id),r(),d("ngIf",n.doctors==null?null:n.doctors.length)("ngIfElse",m)}}var Ht=class l{constructor(a,n,o,m){this.fb=a;this.snack=n;this.adminService=o;this.dialog=m;this.addForm=this.fb.group({name:["",[y.required,y.minLength(3)]],description:[""]}),this.editForm=this.fb.group({name:["",[y.required,y.minLength(3)]],description:[""]})}addForm;editForm;data=[];filteredDepartments=[];loading=!1;search=new U("",{nonNullable:!0});sortDept=new U("asc",{nonNullable:!0});editingId=null;subs=[];get f(){return this.addForm.controls}ngOnInit(){this.fetchDepartments(),this.subs.push(this.search.valueChanges.subscribe(()=>this.applyFilters()),this.sortDept.valueChanges.subscribe(()=>this.applyFilters()))}ngOnDestroy(){this.subs.forEach(a=>a.unsubscribe())}fetchDepartments(){this.loading=!0,this.adminService.getDepartments().subscribe({next:a=>{this.data=Array.isArray(a)?a:[],this.applyFilters(),this.loading=!1},error:a=>{let n=typeof a=="string"?a:a?.message||"Unknown error";this.snack.open("Something went wrong while loading departments. Please try again.","Close",{duration:3e3}),this.loading=!1}})}applyFilters(){let a=this.search.value.trim().toLowerCase(),n=this.sortDept.value;this.filteredDepartments=this.data.map(o=>{let m=o.name.toLowerCase().includes(a)||(o.description||"").toLowerCase().includes(a),c=o.doctors?.filter(u=>`${u.name} ${u.email} ${u.status}`.toLowerCase().includes(a))??[];return m||c.length>0?b(v({},o),{doctors:c}):null}).filter(o=>o!==null).sort((o,m)=>n==="asc"?o.name.localeCompare(m.name):m.name.localeCompare(o.name))}addDepartment(){if(this.addForm.invalid){this.addForm.markAllAsTouched();return}let a=this.addForm.value;this.adminService.addDepartment(a).subscribe({next:()=>{this.snack.open("Department added successfully","OK",{duration:2e3}),this.addForm.reset({name:"",description:""}),this.fetchDepartments()},error:n=>{let o=typeof n=="string"?n:n?.message||"Unknown error";this.snack.open(`Failed to add department: ${o}`,"Close",{duration:2500})}})}cancelEdit(){this.editingId=null}editDepartment(a){this.editingId=a.id,this.editForm.reset({name:a.name,description:a.description||""})}saveDepartment(a){if(this.editForm.invalid){this.editForm.markAllAsTouched();return}let{name:n,description:o}=this.editForm.value,m={name:n,description:o};this.adminService.updateDepartment(a.id,m).subscribe({next:()=>{this.data=this.data.map(c=>c.id===a.id?b(v({},c),{name:n,description:o||""}):c),this.applyFilters(),this.editingId=null,this.snack.open("Department updated successfully","OK",{duration:2e3})},error:c=>{let u=typeof c=="string"?c:c?.message||"Unknown error";this.snack.open(`Failed to update department: ${u}`,"Close",{duration:2500})}})}toggleDoctor(a,n){this.adminService.toggleBan(n.email).subscribe({next:o=>{this.snack.open(o?.message||"Doctor status updated","Close",{duration:2500}),this.data=this.data.map(m=>m.id===a.id?b(v({},m),{doctors:m.doctors?.map(c=>c.email===n.email?b(v({},c),{status:c.status==="active"?"inactive":"active"}):c)}):m),this.applyFilters()},error:o=>{let m=typeof o=="string"?o:o?.message||"Unknown error";this.snack.open(m,"Close",{duration:2500})}})}removeDepartment(a){this.adminService.deleteDepartment(a.id).subscribe({next:()=>{this.data=this.data.filter(n=>n.id!==a.id),this.applyFilters(),this.snack.open(`Removed ${a.name}`,"OK",{duration:1800})},error:n=>{let o=typeof n=="string"?n:n?.message||"Unknown error";this.snack.open(`Failed to remove department: ${o}`,"Close",{duration:2500})}})}viewDoctor(a){this.adminService.getDoctorById(a.doctorId).subscribe({next:n=>{this.dialog.open(j,{width:"90vw",maxWidth:"900px",data:n,panelClass:"doctor-dialog-container"})},error:n=>console.error(n)})}static \u0275fac=function(n){return new(n||l)(M(it),M(st),M(kt),M(Pt))};static \u0275cmp=S({type:l,selectors:[["admin-departments"]],decls:36,vars:6,consts:[["viewBtns",""],["empty",""],[1,"title"],[1,"toolbar"],["appearance","outline",1,"grow"],["matInput","","placeholder","e.g., Cardiology, Dr. Layla, active\u2026",3,"formControl"],["matSuffix",""],["appearance","outline",1,"w"],[3,"formControl"],["value","asc"],["value","desc"],[1,"glass-card","add-card"],[1,"add-grid",3,"ngSubmit","formGroup"],["appearance","outline"],["matInput","","formControlName","name","placeholder","e.g., Oncology"],[4,"ngIf"],["matInput","","formControlName","description","placeholder","Short description"],[1,"grow"],["mat-flat-button","","color","primary","type","submit"],["multi","",1,"dept-accordion"],["class","glass-panel",4,"ngFor","ngForOf"],[1,"glass-panel"],[1,"dep-header"],[1,"dep-title"],[1,"dep-icon"],[1,"name"],[1,"meta"],["matBadgeColor","accent","matBadgeSize","small",1,"count-chip",3,"matBadge"],[4,"ngIf","ngIfElse"],["class","edit-grid",3,"formGroup","ngSubmit",4,"ngIf"],["class","docs-grid",4,"ngIf","ngIfElse"],["mat-stroked-button","","color","primary",3,"click"],["mat-stroked-button","",3,"click"],["mat-stroked-button","","color","warn",3,"click"],[1,"edit-grid",3,"ngSubmit","formGroup"],["matInput","","formControlName","name"],["matInput","","formControlName","description"],[1,"edit-actions"],["mat-stroked-button","","type","button",3,"click"],[1,"docs-grid"],["class","doc-card",4,"ngFor","ngForOf"],[1,"doc-card"],[1,"doc-row"],[1,"doc-name"],[3,"color"],[1,"doc-meta"],[1,"row"],[1,"link",3,"href"],[1,"muted"],["class","row",4,"ngIf"],[1,"doc-actions"],["mat-stroked-button","",3,"click","color"],[1,"empty"]],template:function(n,o){n&1&&(i(0,"h2",2),e(1,"Departments & Doctors"),t(),i(2,"div",3)(3,"mat-form-field",4)(4,"mat-label"),e(5,"Search departments or doctors"),t(),g(6,"input",5),i(7,"mat-icon",6),e(8,"search"),t()(),i(9,"mat-form-field",7)(10,"mat-label"),e(11,"Sort departments"),t(),i(12,"mat-select",8)(13,"mat-option",9),e(14,"A \u2192 Z"),t(),i(15,"mat-option",10),e(16,"Z \u2192 A"),t()()()(),i(17,"mat-card",11)(18,"form",12),x("ngSubmit",function(){return o.addDepartment()}),i(19,"mat-form-field",13)(20,"mat-label"),e(21,"Department name"),t(),g(22,"input",14),_(23,me,2,0,"mat-error",15)(24,ce,2,0,"mat-error",15),t(),i(25,"mat-form-field",13)(26,"mat-label"),e(27,"Description (optional)"),t(),g(28,"input",16),t(),g(29,"span",17),i(30,"button",18)(31,"mat-icon"),e(32,"add"),t(),e(33," Add Department "),t()()(),i(34,"mat-accordion",19),_(35,xe,19,7,"mat-expansion-panel",20),t()),n&2&&(r(6),d("formControl",o.search),r(6),d("formControl",o.sortDept),r(6),d("formGroup",o.addForm),r(5),d("ngIf",o.f.name.touched&&(o.f.name.errors==null?null:o.f.name.errors.required)),r(),d("ngIf",o.f.name.touched&&(o.f.name.errors==null?null:o.f.name.errors.minlength)),r(11),d("ngForOf",o.filteredDepartments))},dependencies:[F,k,I,ot,X,W,J,Q,tt,et,nt,N,T,Et,St,wt,yt,Dt,R,z,$,B,V,A,ct,mt,at,rt,lt,pt,dt,Mt,ht,vt,gt,ut,_t,ft],styles:[".title[_ngcontent-%COMP%]{margin:0 0 .8rem}.toolbar[_ngcontent-%COMP%]{display:flex;gap:.6rem;align-items:center;margin-bottom:.8rem}.grow[_ngcontent-%COMP%]{flex:1 1 auto}.w[_ngcontent-%COMP%]{width:200px;min-width:180px}.glass-card[_ngcontent-%COMP%], .doc-card[_ngcontent-%COMP%]{border-radius:18px;border:1px solid rgba(255,255,255,.08);background:linear-gradient(180deg,#ffffff08,#ffffff05),#1018288c;-webkit-backdrop-filter:blur(12px) saturate(120%);backdrop-filter:blur(12px) saturate(120%)}.add-card[_ngcontent-%COMP%]{padding:.9rem;margin-bottom:1rem}.add-grid[_ngcontent-%COMP%]{display:grid;gap:.8rem;grid-template-columns:1fr 1fr auto}@media (max-width: 880px){.add-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.dept-accordion[_ngcontent-%COMP%]{display:block}.glass-panel[_ngcontent-%COMP%]{border-radius:16px!important;margin-bottom:.75rem;overflow:hidden;border:1px solid rgba(255,255,255,.08);background:linear-gradient(180deg,#ffffff08,#ffffff05),#1018288c;-webkit-backdrop-filter:blur(10px) saturate(120%);backdrop-filter:blur(10px) saturate(120%)}.dep-header[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:space-between;gap:.6rem}.dep-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.dep-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;opacity:.9}.dep-title[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:800;font-size:1.05rem}.dep-title[_ngcontent-%COMP%]   .desc[_ngcontent-%COMP%]{opacity:.85}.meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.count-chip[_ngcontent-%COMP%]{--mdc-chip-container-height: 28px;--mdc-chip-label-text-size: .85rem;background:#ffffff0f;border:1px solid rgba(255,255,255,.12)}.docs-grid[_ngcontent-%COMP%]{display:grid;gap:.85rem;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));padding:.8rem}.doc-card[_ngcontent-%COMP%]{padding:.8rem}.doc-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:.5rem;margin-bottom:.4rem}.doc-name[_ngcontent-%COMP%]{font-weight:800;letter-spacing:.2px}.doc-meta[_ngcontent-%COMP%]{display:grid;gap:.35rem;margin:.4rem 0 .3rem}.row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.45rem}.row[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;opacity:.85}.link[_ngcontent-%COMP%]{color:var(--text);text-decoration:none}.link[_ngcontent-%COMP%]:hover{text-decoration:underline}.muted[_ngcontent-%COMP%]{opacity:.85}.doc-actions[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;gap:.5rem}.empty[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.45rem;padding:.8rem 1rem;opacity:.9}.empty[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}"]})};export{Ht as AdminDepartmentsComponent};
