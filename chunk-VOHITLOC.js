import{a as ae}from"./chunk-2SPCR7JC.js";import{a as ie}from"./chunk-APZWTK3L.js";import{c as Y}from"./chunk-EEDQUWWO.js";import{a as te}from"./chunk-FNX66O3M.js";import"./chunk-JXSMCY7E.js";import"./chunk-3RK6DDJD.js";import{a as W,b as H,e as J,h as K,i as Q,m as $,n as ee}from"./chunk-AK7HCWPM.js";import"./chunk-GGQ7LRWG.js";import{a as oe}from"./chunk-5Z2H6K7H.js";import"./chunk-ZN66PTI3.js";import{c as v,d as C,f as d,g as y,h as re,i as ne}from"./chunk-NQP6NLRO.js";import"./chunk-Z4D3JJEG.js";import{a as X,b as Z}from"./chunk-ENKIQ3XX.js";import{A as z,b as B,d as p,f as R,g as D,l as F,o as A,r as q,y as U}from"./chunk-K2DA6FBL.js";import{T as j,Y as V,Z as G}from"./chunk-LVPX6TEL.js";import{b as N}from"./chunk-P6PSD35X.js";import{d as I,e as T,h as L}from"./chunk-L73FSOJZ.js";import{$a as g,Ab as k,Cb as h,Eb as x,Gc as O,La as a,Pa as b,Rc as w,Sb as i,Tb as _,Ub as E,Wa as P,ea as s,ja as M,ka as S,qb as l,rb as t,sb as e,tb as u}from"./chunk-WZIMFKHB.js";function le(o,m){o&1&&(t(0,"mat-error"),i(1,"Email is required"),e())}function se(o,m){o&1&&(t(0,"mat-error"),i(1,"Enter a valid email"),e())}function pe(o,m){o&1&&(t(0,"mat-error"),i(1,"Password is required"),e())}function de(o,m){o&1&&(t(0,"mat-error"),i(1,"Min 6 characters"),e())}function ce(o,m){if(o&1&&(t(0,"p",22),i(1),e()),o&2){let r=x();a(),_(r.apiError)}}function fe(o,m){if(o&1){let r=k();t(0,"button",23),h("click",function(){M(r);let c=x();return S(c.goToOtp())}),i(1," Verify with OTP "),e()}}var me=class o{constructor(m,r){this.socketService=m;this.adminSocketService=r}fb=s(U);router=s(I);auth=s(N);snackBar=s(te);doctorProfile=s(ie,{optional:!0});hide=!0;loading=!1;apiError=null;otpRequired=!1;form=this.fb.group({email:["",[p.required,p.email]],password:["",[p.required,p.minLength(6)]]});submit(){if(this.form.invalid){this.form.markAllAsTouched();return}let m={email:(this.form.value.email??"").trim().toLowerCase(),password:this.form.value.password??""};this.loading=!0,this.apiError=null,this.auth.login(m).subscribe({next:r=>{this.loading=!1,r.token&&r.role==="ADMIN"?this.adminSocketService.connect():r.token&&this.socketService.connect(r.id,r.role);let n=this.routeForRole(r.role);if(r.role==="DOCTOR"&&this.doctorProfile){this.doctorProfile.refreshProfile().subscribe({next:c=>{let f=r.doctorStatus;f==="NEW"||f==="REJECTED"?this.router.navigateByUrl("/doctor/profile"):f==="PENDING"?this.snackBar.open("Your profile is still pending approval. Please wait for admin confirmation.","Close",{duration:5e3}):f==="ACCEPTED"&&(this.doctorProfile?.markAsUnlocked(),this.router.navigateByUrl("/doctor/dashboard"))},error:()=>this.router.navigateByUrl(n)});return}this.router.navigateByUrl(n)},error:r=>{if(this.loading=!1,this.apiError=r,r==="Please verify your account with the OTP sent to your email and phone."||r==="Your OTP expired. A new one has been sent to your email and phone."){let n=this.form.value.email?.trim();localStorage.setItem("otpEmail",n?.toString()??""),this.router.navigateByUrl("/auth/otp")}}})}routeForRole(m){switch(m){case"ADMIN":return"/admin";case"DOCTOR":return"/doctor";default:return"/patient"}}goToOtp(){let m=this.form.value.email?.trim();this.router.navigateByUrl("/auth/otp")}static \u0275fac=function(r){return new(r||o)(b(oe),b(ae))};static \u0275cmp=P({type:o,selectors:[["app-login"]],decls:54,vars:13,consts:[[1,"auth-shell"],[1,"auth-frame"],[1,"hero-pane"],[1,"brand"],["src","https://ik.imagekit.io/a2wpi1kd9/imgToUrl/image-to-url_HEow9eLbR","alt","Medtik",1,"brand-mark"],[1,"tag"],[1,"benefits"],[1,"form-pane"],[1,"sub"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"stagger"],["matInput","","type","email","formControlName","email","autocomplete","email"],["matSuffix",""],[4,"ngIf"],["matInput","","formControlName","password","autocomplete","current-password",3,"type"],["mat-icon-button","","matSuffix","","type","button","aria-label","Toggle password",3,"click"],["class","api-error","role","alert",4,"ngIf"],["mat-stroked-button","","color","accent",3,"click",4,"ngIf"],["mat-flat-button","","color","primary","type","submit",1,"submit","stagger",3,"disabled"],[1,"aux","stagger",2,"display","flex","justify-content","space-between","align-items","center","margin-top","16px"],["routerLink","/auth/forgot",1,"forgot-link"],["mat-stroked-button","","color","primary","routerLink","/auth/sign-up"],["role","alert",1,"api-error"],["mat-stroked-button","","color","accent",3,"click"]],template:function(r,n){r&1&&(t(0,"div",0)(1,"div",1)(2,"aside",2)(3,"div",3),u(4,"img",4),t(5,"h1"),i(6,"Medtik"),e(),t(7,"p",5),i(8,"Care that comes to you"),e()(),t(9,"ul",6)(10,"li")(11,"mat-icon"),i(12,"military_tech"),e(),i(13," Best doctors in the middle east"),e(),t(14,"li")(15,"mat-icon"),i(16,"videocam"),e(),i(17," Chat, voice, or video - your choice"),e(),t(18,"li")(19,"mat-icon"),i(20,"payments"),e(),i(21," Secure, verified checkout with Paymob"),e()()(),t(22,"main",7)(23,"h2"),i(24,"Welcome back"),e(),t(25,"p",8),i(26,"Sign in to manage your consultations"),e(),t(27,"form",9),h("ngSubmit",function(){return n.submit()}),t(28,"mat-form-field",10)(29,"mat-label"),i(30,"Email"),e(),u(31,"input",11),t(32,"mat-icon",12),i(33,"mail"),e(),g(34,le,2,0,"mat-error",13)(35,se,2,0,"mat-error",13),e(),t(36,"mat-form-field",10)(37,"mat-label"),i(38,"Password"),e(),u(39,"input",14),t(40,"button",15),h("click",function(){return n.hide=!n.hide}),t(41,"mat-icon"),i(42),e()(),g(43,pe,2,0,"mat-error",13)(44,de,2,0,"mat-error",13),e(),g(45,ce,2,1,"p",16)(46,fe,2,0,"button",17),t(47,"button",18),i(48),e()(),t(49,"div",19)(50,"a",20),i(51,"Forgot password?"),e(),t(52,"button",21),i(53," Sign up "),e()()()()()),r&2&&(l("@flyIn",void 0),a(22),l("@staggerIn",void 0),a(5),l("formGroup",n.form),a(7),l("ngIf",n.form.controls.email.hasError("required")),a(),l("ngIf",n.form.controls.email.hasError("email")),a(4),l("type",n.hide?"password":"text"),a(3),_(n.hide?"visibility":"visibility_off"),a(),l("ngIf",n.form.controls.password.hasError("required")),a(),l("ngIf",n.form.controls.password.hasError("minlength")),a(),l("ngIf",n.apiError),a(),l("ngIf",n.otpRequired),a(),l("disabled",n.loading),a(),E(" ",n.loading?"Signing in...":"Sign in"," "))},dependencies:[w,O,z,F,B,R,D,A,q,L,T,Y,Q,K,W,H,J,ee,$,G,V,j,Z,X],styles:['@charset "UTF-8";.auth-shell[_ngcontent-%COMP%]{min-height:100svh;display:flex;align-items:center;justify-content:center;padding:clamp(16px,4vmin,32px)}.auth-frame[_ngcontent-%COMP%]{width:min(960px,96vw);max-height:88svh;overflow:hidden;display:grid;grid-template-columns:1.15fr 1fr;border-radius:24px;background:linear-gradient(180deg,#ffffff08,#ffffff05),#101828b8;-webkit-backdrop-filter:blur(10px) saturate(120%);backdrop-filter:blur(10px) saturate(120%);border:1px solid rgba(255,255,255,.08);box-shadow:0 24px 70px #00000080}.hero-pane[_ngcontent-%COMP%]{position:relative;padding:28px 24px;border-right:1px solid rgba(255,255,255,.06)}.hero-pane[_ngcontent-%COMP%]:before, .hero-pane[_ngcontent-%COMP%]:after{content:"";position:absolute;inset:-20%;background:radial-gradient(40% 35% at 20% 15%,rgba(42,118,183,.28),transparent 60%),radial-gradient(35% 30% at 80% 10%,rgba(29,183,160,.22),transparent 60%),radial-gradient(45% 40% at 60% 80%,rgba(42,118,183,.16),transparent 70%);filter:blur(14px);animation:_ngcontent-%COMP%_drift 16s linear infinite;pointer-events:none;z-index:0}.hero-pane[_ngcontent-%COMP%]:after{animation-duration:22s;animation-direction:reverse;opacity:.7}@keyframes _ngcontent-%COMP%_drift{0%{transform:translate3d(-2%,0,0) rotate(0)}50%{transform:translate3d(2%,1%,0) rotate(4deg)}to{transform:translate3d(-2%,0,0) rotate(0)}}.brand[_ngcontent-%COMP%]{position:relative;z-index:1;display:grid;place-items:center;gap:.35rem;margin-bottom:.75rem;text-align:center}.brand-mark[_ngcontent-%COMP%]{width:110px;height:110px;object-fit:contain;filter:drop-shadow(0 10px 24px rgba(42,118,183,.6))}.brand[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:1.45rem;letter-spacing:.3px;font-weight:800;color:#e6eef6}.tag[_ngcontent-%COMP%]{margin:0;color:#a7b4c5}.benefits[_ngcontent-%COMP%]{position:relative;z-index:1;list-style:none;margin:1rem 0 0;padding:0;display:grid;gap:.5rem}.benefits[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.55rem .65rem;border:1px solid rgba(255,255,255,.06);background:#ffffff05;border-radius:12px;color:#d4dce8}.benefits[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;height:18px;width:18px;color:#8fc7ff}.form-pane[_ngcontent-%COMP%]{padding:28px 20px;display:grid;align-content:start}.form-pane[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:.25rem 0 0;font-weight:800;font-size:clamp(1.25rem,2.2vw,1.6rem);color:#e6eef6}.form-pane[_ngcontent-%COMP%]   .sub[_ngcontent-%COMP%]{margin:.2rem 0 1rem;color:#a7b4c5}form[_ngcontent-%COMP%]{display:grid;gap:.8rem}.submit[_ngcontent-%COMP%]{width:100%;border-radius:12px;margin-top:.25rem}.aux[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:.25rem}.aux[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#a7b4c5;text-decoration:none}.aux[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#e6eaf2}@media (max-width: 900px){.auth-frame[_ngcontent-%COMP%]{grid-template-columns:1fr;max-height:unset}.hero-pane[_ngcontent-%COMP%]{border-right:0;border-bottom:1px solid rgba(255,255,255,.06)}.brand-mark[_ngcontent-%COMP%]{width:120px;height:120px}}@media (max-width: 480px){.auth-frame[_ngcontent-%COMP%]{width:94vw}.hero-pane[_ngcontent-%COMP%], .form-pane[_ngcontent-%COMP%]{padding:18px 14px}}.api-error[_ngcontent-%COMP%]{color:#f44336;font-size:.85rem;margin:-.25rem 0 .5rem}'],data:{animation:[v("flyIn",[y(":enter",[d({opacity:0,transform:"translateY(16px) scale(.98)"}),C("500ms cubic-bezier(.2,.8,.2,1)",d({opacity:1,transform:"none"}))])]),v("staggerIn",[y(":enter",[re(".stagger",[d({opacity:0,transform:"translateY(10px)"}),ne(60,C("380ms ease-out",d({opacity:1,transform:"none"})))])])])]}})};export{me as LoginComponent};
