import{a as h,b as pt,c as ft}from"./chunk-E2JTTORF.js";import{a as ut,b as gt}from"./chunk-VCQXB3R3.js";import{a as Z,b as tt,c as et,d as nt,e as it,f as at,g as rt,h as ot,i as lt,j as mt,k as st,l as dt}from"./chunk-EU2GGAHC.js";import{a as C,b as ct}from"./chunk-UKL3BBPM.js";import{a as _t}from"./chunk-VZ55A3QX.js";import{a as K,d as W}from"./chunk-LXWUKR3B.js";import"./chunk-F5X5MWHG.js";import{a as X,b as Y}from"./chunk-XGLVXY7I.js";import"./chunk-ZCFZR4S3.js";import"./chunk-4K5T2QBN.js";import{a as B,e as F,h as j,i as H,m as J,n as G}from"./chunk-LCR2LKFI.js";import"./chunk-BR5LHSVS.js";import"./chunk-OY7Y436C.js";import"./chunk-YCVTR2B7.js";import"./chunk-TR43TC6U.js";import{A as L,b as O,f as R,j as V,n as N}from"./chunk-YN6JIHUF.js";import"./chunk-CUGN3AIA.js";import{a as Q,b as q}from"./chunk-W6QHVSTW.js";import{Y as z,Z as $}from"./chunk-YSTQL2PO.js";import{Bc as T,Db as b,Eb as M,Fb as x,Ga as o,Jc as U,Ka as S,Mc as k,Nb as l,Ob as d,Pb as _,Ra as y,Wa as s,_b as E,ac as I,ea as v,fa as w,fc as D,lb as m,mb as i,nb as a,ob as c,sb as p,tb as f,vb as A,xb as P,zb as g}from"./chunk-HKUWCROW.js";import"./chunk-JKOY2XUY.js";function bt(n,t){n&1&&(i(0,"div",8),c(1,"mat-spinner",9),i(2,"p"),l(3,"Loading users..."),a()())}function Mt(n,t){if(n&1&&(i(0,"div",10)(1,"mat-icon",11),l(2,"error_outline"),a(),i(3,"span"),l(4),a()()),n&2){let e=g();o(4),d(e.error)}}function xt(n,t){n&1&&(i(0,"th",29),l(1,"Name"),a())}function vt(n,t){if(n&1&&(i(0,"td",30)(1,"div",31)(2,"span",32),l(3),a(),i(4,"span",33),l(5),a()()()),n&2){let e=t.$implicit;o(3),d(e.name),o(2),d(e.email)}}function wt(n,t){n&1&&(i(0,"th",29),l(1,"Email"),a())}function St(n,t){if(n&1&&(i(0,"td",30),l(1),a()),n&2){let e=t.$implicit;o(),d(e.email)}}function yt(n,t){n&1&&(i(0,"th",34),l(1,"Phone"),a())}function At(n,t){if(n&1&&(i(0,"td",30),l(1),a()),n&2){let e=t.$implicit;o(),d(e.phoneNumber)}}function Pt(n,t){n&1&&(i(0,"th",29),l(1,"Joined"),a())}function Et(n,t){if(n&1&&(i(0,"td",30),l(1),E(2,"date"),a()),n&2){let e=t.$implicit;o(),d(I(2,1,e.joined,"mediumDate"))}}function It(n,t){n&1&&(i(0,"th",29),l(1,"Status"),a())}function Dt(n,t){if(n&1&&(i(0,"td",30)(1,"mat-chip",35),l(2),a()()),n&2){let e=t.$implicit;o(),m("color",e.status==="active"?"primary":"warn"),o(),_(" ",e.status," ")}}function Tt(n,t){n&1&&c(0,"th",34)}function Ut(n,t){if(n&1){let e=A();i(0,"td",36)(1,"button",37),P("click",function(){let u=v(e).$implicit,ht=g(2);return w(ht.toggleBanUser(u))}),i(2,"mat-icon"),l(3),a(),l(4),a()()}if(n&2){let e=t.$implicit;o(),m("color",e.status==="ACTIVE"?"warn":"primary")("matTooltip",e.status==="ACTIVE"?"Ban user":"Unban user"),o(2),_(" ",e.status==="ACTIVE"?"block":"lock_open"," "),o(),_(" ",e.status==="ACTIVE"?"Ban":"Unban"," ")}}function kt(n,t){n&1&&c(0,"tr",38)}function Ot(n,t){n&1&&c(0,"tr",39)}function Rt(n,t){if(n&1&&(i(0,"div",12)(1,"table",13),p(2,14),s(3,xt,2,0,"th",15)(4,vt,6,2,"td",16),f(),p(5,17),s(6,wt,2,0,"th",15)(7,St,2,1,"td",16),f(),p(8,18),s(9,yt,2,0,"th",19)(10,At,2,1,"td",16),f(),p(11,20),s(12,Pt,2,0,"th",15)(13,Et,3,4,"td",16),f(),p(14,21),s(15,It,2,0,"th",15)(16,Dt,3,2,"td",16),f(),p(17,22),s(18,Tt,1,0,"th",19)(19,Ut,5,4,"td",23),f(),s(20,kt,1,0,"tr",24)(21,Ot,1,0,"tr",25),a(),i(22,"div",26)(23,"div",27),l(24),a(),c(25,"mat-paginator",28),a()()),n&2){let e=g();o(),m("dataSource",e.data),o(19),m("matHeaderRowDef",e.cols),o(),m("matRowDefColumns",e.cols),o(3),d(e.rangeLabel()),o(),m("length",e.data.filteredData.length)("pageSize",e.pageSize)("hidePageSize",!0)}}var Ct=class n{constructor(t){this.adminService=t}cols=["name","email","phone","joined","status","actions"];pageSize=10;filterCtrl=new V("",{nonNullable:!0});data=new dt([]);loading=!0;error=null;paginator;sort;ngAfterViewInit(){this.fetchUsers(),this.data.paginator=this.paginator,this.data.sort=this.sort,this.data.sortingDataAccessor=(t,e)=>{switch(e){case"name":return t.name.toLowerCase();case"joined":return new Date(t.joined).getTime();default:return t[e]}},this.data.filterPredicate=(t,e)=>{let r=e.trim().toLowerCase();return t.name.toLowerCase().includes(r)||t.email.toLowerCase().includes(r)||(t.phoneNumber?.toLowerCase().includes(r)??!1)||t.status.toLowerCase().includes(r)},this.filterCtrl.valueChanges.subscribe(t=>{this.data.filter=(t??"").trim().toLowerCase(),this.data.paginator&&this.data.paginator.firstPage()})}fetchUsers(){this.loading=!0,this.error=null,this.adminService.getAllUsers().subscribe({next:t=>{this.data.data=t,this.loading=!1},error:()=>{this.error="Failed to load users",this.loading=!1}})}toggleBanUser(t){let e=t.status==="ACTIVE"?`Are you sure you want to ban ${t.name}?`:`Are you sure you want to unban ${t.name}?`;confirm(e)&&this.adminService.toggleBan(t.email).subscribe({next:r=>{t.status=t.status==="ACTIVE"?"BANNED":"ACTIVE",this.refresh(),alert(r.message)},error:r=>{console.error(r),alert(r?.message||"Failed to toggle ban status")}})}refresh(){this.data.data=[...this.data.data]}rangeLabel=D(()=>{if(!this.paginator)return"";let t=this.data.filteredData.length,e=this.paginator.pageIndex*this.paginator.pageSize,r=Math.min(e+this.paginator.pageSize,t);return t?`Showing ${e+1}\u2013${r} of ${t}`:"No results"});static \u0275fac=function(e){return new(e||n)(S(_t))};static \u0275cmp=y({type:n,selectors:[["admin-users"]],viewQuery:function(e,r){if(e&1&&(b(C,5),b(h,5)),e&2){let u;M(u=x())&&(r.paginator=u.first),M(u=x())&&(r.sort=u.first)}},decls:12,vars:4,consts:[[1,"title"],[1,"toolbar"],["appearance","outline",1,"search"],["matInput","","placeholder","Name, email, phone or status",3,"formControl"],["matSuffix",""],["class","loading",4,"ngIf"],["class","error",4,"ngIf"],["class","table-wrap mat-elevation-z2",4,"ngIf"],[1,"loading"],["diameter","40"],[1,"error"],["color","warn"],[1,"table-wrap","mat-elevation-z2"],["mat-table","","matSort","",1,"glass-table",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","email"],["matColumnDef","phone"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","joined"],["matColumnDef","status"],["matColumnDef","actions"],["mat-cell","","class","actions",4,"matCellDef"],["mat-header-row","","class","sticky",4,"matHeaderRowDef"],["mat-row","","class","row",4,"matRowDef","matRowDefColumns"],[1,"table-footer"],[1,"range"],["showFirstLastButtons","",3,"length","pageSize","hidePageSize"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"stack"],[1,"strong"],[1,"muted","email-under-name"],["mat-header-cell",""],[3,"color"],["mat-cell","",1,"actions"],["mat-stroked-button","",3,"click","color","matTooltip"],["mat-header-row","",1,"sticky"],["mat-row","",1,"row"]],template:function(e,r){e&1&&(i(0,"h2",0),l(1,"Users"),a(),i(2,"div",1)(3,"mat-form-field",2)(4,"mat-label"),l(5,"Search users"),a(),c(6,"input",3),i(7,"mat-icon",4),l(8,"searchh"),a()()(),s(9,bt,4,0,"div",5)(10,Mt,5,1,"div",6)(11,Rt,26,7,"div",7)),e&2&&(o(6),m("formControl",r.filterCtrl),o(3),m("ngIf",r.loading),o(),m("ngIf",r.error),o(),m("ngIf",!r.loading&&!r.error))},dependencies:[k,T,L,O,R,N,st,Z,et,rt,nt,tt,ot,it,at,lt,mt,ct,C,ft,h,pt,H,j,B,F,G,J,$,z,q,Q,W,K,Y,X,gt,ut,U],styles:[".title[_ngcontent-%COMP%]{margin:0 0 .8rem}.toolbar[_ngcontent-%COMP%]{display:flex;gap:.6rem;align-items:center;margin-bottom:.8rem}.search[_ngcontent-%COMP%]{width:min(520px,100%)}.table-wrap[_ngcontent-%COMP%]{border-radius:18px;overflow:hidden;border:1px solid rgba(255,255,255,.08);background:linear-gradient(180deg,#ffffff08,#ffffff05),#1018288c;-webkit-backdrop-filter:blur(12px) saturate(120%);backdrop-filter:blur(12px) saturate(120%)}[_nghost-%COMP%]     .mat-mdc-table, [_nghost-%COMP%]     .mat-mdc-paginator{background:transparent!important}table.glass-table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:.85rem 1rem}th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:2;background:#ffffff0f;color:var(--text);font-weight:700;-webkit-backdrop-filter:blur(6px) saturate(120%);backdrop-filter:blur(6px) saturate(120%);border-bottom:1px solid rgba(255,255,255,.08)}tr.row[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background:#ffffff08}tr.row[_ngcontent-%COMP%]:nth-child(2n)   td[_ngcontent-%COMP%]{background:#ffffff04}.stack[_ngcontent-%COMP%]{display:flex;flex-direction:column}.strong[_ngcontent-%COMP%]{font-weight:700}.muted[_ngcontent-%COMP%]{opacity:.8}.email-under-name[_ngcontent-%COMP%]{display:none}.actions[_ngcontent-%COMP%]{text-align:right;white-space:nowrap}.table-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:.55rem .75rem;border-top:1px solid rgba(255,255,255,.08);background:#0000001f;-webkit-backdrop-filter:blur(6px);backdrop-filter:blur(6px)}.range[_ngcontent-%COMP%]{opacity:.85;font-size:.92rem}@media (max-width: 900px){th[mat-header-cell][_ngcontent-%COMP%]:nth-child(2), td[mat-cell][_ngcontent-%COMP%]:nth-child(2){display:none}.email-under-name[_ngcontent-%COMP%]{display:block}}.table-wrap[_ngcontent-%COMP%]{background:#ffffff14;border-radius:16px;overflow:hidden;-webkit-backdrop-filter:blur(6px);backdrop-filter:blur(6px)}.loading[_ngcontent-%COMP%], .error[_ngcontent-%COMP%]{text-align:center;margin-top:2rem}.error[_ngcontent-%COMP%]{color:#f44336;display:flex;align-items:center;justify-content:center;gap:8px}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem}"]})};export{Ct as AdminUsersComponent};
