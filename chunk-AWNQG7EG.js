import{a as l,b as m}from"./chunk-NZSQ27MY.js";import{$ as h,Sc as d,T as n,Tc as c,W as g,l as i,o as p,z as r}from"./chunk-HKUWCROW.js";import{a as o}from"./chunk-JKOY2XUY.js";var b=class a{http=h(c);auth=h(m);baseUrl=l.apiBaseUrl;getOptions(e={}){if(l.production)return o({withCredentials:!0},e);{let t=this.auth.getToken();if(!t)throw new Error("Admin session expired.");let s=new d({Authorization:`Bearer ${t}`});return o({headers:s},e)}}registerDoctor(e){return console.log("Registering doctor with payload:",e),this.http.post(`${this.baseUrl}/auth/register-doctor`,e,this.getOptions()).pipe(r(t=>this.handleError(t)))}getAllUsers(){return this.http.get(`${this.baseUrl}/admin/users`,this.getOptions()).pipe(n(e=>console.log("Fetched users:",e)),r(e=>this.handleError(e)))}toggleBan(e){return this.http.post(`${this.baseUrl}/admin/toggle-ban`,{email:e},this.getOptions()).pipe(r(t=>this.handleError(t)))}getDepartments(){return this.http.get(`${this.baseUrl}/departments`,this.getOptions()).pipe(r(e=>this.handleError(e)))}addDepartment(e){return this.http.post(`${this.baseUrl}/admin/departments`,e,this.getOptions()).pipe(r(t=>this.handleError(t)))}updateDepartment(e,t){return this.http.put(`${this.baseUrl}/admin/departments/${e}`,t,this.getOptions()).pipe(r(s=>this.handleError(s)))}deleteDepartment(e){return this.http.delete(`${this.baseUrl}/admin/departments/${e}`,this.getOptions()).pipe(r(t=>this.handleError(t)))}getDoctorUpdateRequests(){return this.http.get(`${this.baseUrl}/admin/doctor-update-requests`,this.getOptions()).pipe(n(e=>console.log("API Response inside service:",e)),r(e=>this.handleError(e)))}acceptRequest(e){return this.http.post(`${this.baseUrl}/admin/doctor-requests/${e}/accept`,{},this.getOptions()).pipe(r(t=>this.handleError(t)))}rejectRequest(e,t){return this.http.post(`${this.baseUrl}/admin/doctor-requests/${e}/reject`,{note:t},this.getOptions()).pipe(r(s=>this.handleError(s)))}deleteRequest(e){return this.http.delete(`${this.baseUrl}/admin/doctor-requests/${e}`,this.getOptions()).pipe(r(t=>this.handleError(t)))}getNotifications(){return this.http.get(`${this.baseUrl}/notifications`,this.getOptions()).pipe(n(e=>console.log("API Response inside service:",e)),p(e=>e.notifications||[]),r(e=>{let t="Failed to load notifications";return e?.error?.message&&(t=e.error.message),i(()=>new Error(t))}))}markNotificationRead(e){return this.http.patch(`${this.baseUrl}/notifications/${e}/read`,{},this.getOptions())}markNotificationUnRead(e){return this.http.patch(`${this.baseUrl}/notifications/${e}/unread`,{},this.getOptions())}deleteNotification(e){return this.http.delete(`${this.baseUrl}/notifications/${e}`,this.getOptions())}getDoctorById(e){return this.http.get(`${this.baseUrl}/admin/doctor/${e}`,this.getOptions())}getTransactions(){return this.http.get(`${this.baseUrl}/transactions`,this.getOptions()).pipe(p(e=>(console.log("Fetched transactions:",e),e)),r(e=>i(()=>e)))}handleError(e){let t="Something went wrong. Please try again later.",s=e.error;return s?typeof s=="string"?t=s:typeof s=="object"&&(t=s.message??s.error??t):e.message&&(t=e.message),i(()=>new Error(t))}static \u0275fac=function(t){return new(t||a)};static \u0275prov=g({token:a,factory:a.\u0275fac,providedIn:"root"})};export{b as a};
