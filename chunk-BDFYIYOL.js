import{a as h,b as pe,c as fe}from"./chunk-E2JTTORF.js";import{a as ue,b as ge}from"./chunk-VCQXB3R3.js";import{a as Z,b as ee,c as te,d as ne,e as ie,f as ae,g as re,h as oe,i as le,j as me,k as se,l as de}from"./chunk-EU2GGAHC.js";import{a as C,b as ce}from"./chunk-UKL3BBPM.js";import{a as _e}from"./chunk-VZ55A3QX.js";import{a as K,d as W}from"./chunk-LXWUKR3B.js";import"./chunk-F5X5MWHG.js";import{a as X,b as Y}from"./chunk-XGLVXY7I.js";import"./chunk-ZCFZR4S3.js";import"./chunk-4K5T2QBN.js";import{a as B,e as F,h as j,i as H,m as J,n as G}from"./chunk-LCR2LKFI.js";import"./chunk-BR5LHSVS.js";import"./chunk-OY7Y436C.js";import"./chunk-YCVTR2B7.js";import"./chunk-TR43TC6U.js";import{A as L,b as O,f as N,j as R,n as V}from"./chunk-YN6JIHUF.js";import"./chunk-CUGN3AIA.js";import{a as Q,b as q}from"./chunk-W6QHVSTW.js";import{Y as z,Z as $}from"./chunk-YSTQL2PO.js";import{Bc as T,Db as b,Eb as M,Fb as x,Ga as o,Jc as U,Ka as S,Mc as k,Nb as l,Ob as d,Pb as _,Ra as y,Wa as s,_b as E,ac as I,ea as v,fa as w,fc as D,lb as m,mb as i,nb as a,ob as c,sb as p,tb as f,vb as A,xb as P,zb as g}from"./chunk-HKUWCROW.js";import"./chunk-JKOY2XUY.js";function be(n,e){n&1&&(i(0,"div",8),c(1,"mat-spinner",9),i(2,"p"),l(3,"Loading users..."),a()())}function Me(n,e){if(n&1&&(i(0,"div",10)(1,"mat-icon",11),l(2,"error_outline"),a(),i(3,"span"),l(4),a()()),n&2){let t=g();o(4),d(t.error)}}function xe(n,e){n&1&&(i(0,"th",29),l(1,"Name"),a())}function ve(n,e){if(n&1&&(i(0,"td",30)(1,"div",31)(2,"span",32),l(3),a(),i(4,"span",33),l(5),a()()()),n&2){let t=e.$implicit;o(3),d(t.name),o(2),d(t.email)}}function we(n,e){n&1&&(i(0,"th",29),l(1,"Email"),a())}function Se(n,e){if(n&1&&(i(0,"td",30),l(1),a()),n&2){let t=e.$implicit;o(),d(t.email)}}function ye(n,e){n&1&&(i(0,"th",34),l(1,"Phone"),a())}function Ae(n,e){if(n&1&&(i(0,"td",30),l(1),a()),n&2){let t=e.$implicit;o(),d(t.phoneNumber)}}function Pe(n,e){n&1&&(i(0,"th",29),l(1,"Joined"),a())}function Ee(n,e){if(n&1&&(i(0,"td",30),l(1),E(2,"date"),a()),n&2){let t=e.$implicit;o(),d(I(2,1,t.joined,"mediumDate"))}}function Ie(n,e){n&1&&(i(0,"th",29),l(1,"Status"),a())}function De(n,e){if(n&1&&(i(0,"td",30)(1,"mat-chip",35),l(2),a()()),n&2){let t=e.$implicit;o(),m("color",t.status==="active"?"primary":"warn"),o(),_(" ",t.status," ")}}function Te(n,e){n&1&&c(0,"th",34)}function Ue(n,e){if(n&1){let t=A();i(0,"td",36)(1,"button",37),P("click",function(){let u=v(t).$implicit,he=g(2);return w(he.toggleBanUser(u))}),i(2,"mat-icon"),l(3),a(),l(4),a()()}if(n&2){let t=e.$implicit;o(),m("color",t.status==="ACTIVE"?"warn":"primary")("matTooltip",t.status==="ACTIVE"?"Ban user":"Unban user"),o(2),_(" ",t.status==="ACTIVE"?"block":"lock_open"," "),o(),_(" ",t.status==="ACTIVE"?"Ban":"Unban"," ")}}function ke(n,e){n&1&&c(0,"tr",38)}function Oe(n,e){n&1&&c(0,"tr",39)}function Ne(n,e){if(n&1&&(i(0,"div",12)(1,"table",13),p(2,14),s(3,xe,2,0,"th",15)(4,ve,6,2,"td",16),f(),p(5,17),s(6,we,2,0,"th",15)(7,Se,2,1,"td",16),f(),p(8,18),s(9,ye,2,0,"th",19)(10,Ae,2,1,"td",16),f(),p(11,20),s(12,Pe,2,0,"th",15)(13,Ee,3,4,"td",16),f(),p(14,21),s(15,Ie,2,0,"th",15)(16,De,3,2,"td",16),f(),p(17,22),s(18,Te,1,0,"th",19)(19,Ue,5,4,"td",23),f(),s(20,ke,1,0,"tr",24)(21,Oe,1,0,"tr",25),a(),i(22,"div",26)(23,"div",27),l(24),a(),c(25,"mat-paginator",28),a()()),n&2){let t=g();o(),m("dataSource",t.data),o(19),m("matHeaderRowDef",t.cols),o(),m("matRowDefColumns",t.cols),o(3),d(t.rangeLabel()),o(),m("length",t.data.filteredData.length)("pageSize",t.pageSize)("hidePageSize",!0)}}var Ce=class n{constructor(e){this.adminService=e}cols=["name","email","phone","joined","status","actions"];pageSize=10;filterCtrl=new R("",{nonNullable:!0});data=new de([]);loading=!0;error=null;paginator;sort;ngAfterViewInit(){this.fetchUsers(),this.data.paginator=this.paginator,this.data.sort=this.sort,this.data.sortingDataAccessor=(e,t)=>{switch(t){case"name":return e.name.toLowerCase();case"joined":return new Date(e.joined).getTime();default:return e[t]}},this.data.filterPredicate=(e,t)=>{let r=t.trim().toLowerCase();return e.name.toLowerCase().includes(r)||e.email.toLowerCase().includes(r)||(e.phoneNumber?.toLowerCase().includes(r)??!1)||e.status.toLowerCase().includes(r)},this.filterCtrl.valueChanges.subscribe(e=>{this.data.filter=(e??"").trim().toLowerCase(),this.data.paginator&&this.data.paginator.firstPage()})}fetchUsers(){this.loading=!0,this.error=null,this.adminService.getAllUsers().subscribe({next:e=>{this.data.data=e,this.loading=!1},error:()=>{this.error="Failed to load users",this.loading=!1}})}toggleBanUser(e){let t=e.status==="ACTIVE"?`Are you sure you want to ban ${e.name}?`:`Are you sure you want to unban ${e.name}?`;confirm(t)&&this.adminService.toggleBan(e.email).subscribe({next:r=>{e.status=e.status==="ACTIVE"?"BANNED":"ACTIVE",this.refresh(),alert(r.message)},error:r=>{console.error(r),alert(r?.message||"Failed to toggle ban status")}})}refresh(){this.data.data=[...this.data.data]}rangeLabel=D(()=>{if(!this.paginator)return"";let e=this.data.filteredData.length,t=this.paginator.pageIndex*this.paginator.pageSize,r=Math.min(t+this.paginator.pageSize,e);return e?`Showing ${t+1}\u2013${r} of ${e}`:"No results"});static \u0275fac=function(t){return new(t||n)(S(_e))};static \u0275cmp=y({type:n,selectors:[["admin-users"]],viewQuery:function(t,r){if(t&1&&(b(C,5),b(h,5)),t&2){let u;M(u=x())&&(r.paginator=u.first),M(u=x())&&(r.sort=u.first)}},decls:12,vars:4,consts:[[1,"title"],[1,"toolbar"],["appearance","outline",1,"search"],["matInput","","placeholder","Name, email, phone or status",3,"formControl"],["matSuffix",""],["class","loading",4,"ngIf"],["class","error",4,"ngIf"],["class","table-wrap mat-elevation-z2",4,"ngIf"],[1,"loading"],["diameter","40"],[1,"error"],["color","warn"],[1,"table-wrap","mat-elevation-z2"],["mat-table","","matSort","",1,"glass-table",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","email"],["matColumnDef","phone"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","joined"],["matColumnDef","status"],["matColumnDef","actions"],["mat-cell","","class","actions",4,"matCellDef"],["mat-header-row","","class","sticky",4,"matHeaderRowDef"],["mat-row","","class","row",4,"matRowDef","matRowDefColumns"],[1,"table-footer"],[1,"range"],["showFirstLastButtons","",3,"length","pageSize","hidePageSize"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"stack"],[1,"strong"],[1,"muted","email-under-name"],["mat-header-cell",""],[3,"color"],["mat-cell","",1,"actions"],["mat-stroked-button","",3,"click","color","matTooltip"],["mat-header-row","",1,"sticky"],["mat-row","",1,"row"]],template:function(t,r){t&1&&(i(0,"h2",0),l(1,"Users"),a(),i(2,"div",1)(3,"mat-form-field",2)(4,"mat-label"),l(5,"Search users"),a(),c(6,"input",3),i(7,"mat-icon",4),l(8,"searchh"),a()()(),s(9,be,4,0,"div",5)(10,Me,5,1,"div",6)(11,Ne,26,7,"div",7)),t&2&&(o(6),m("formControl",r.filterCtrl),o(3),m("ngIf",r.loading),o(),m("ngIf",r.error),o(),m("ngIf",!r.loading&&!r.error))},dependencies:[k,T,L,O,N,V,se,Z,te,re,ne,ee,oe,ie,ae,le,me,ce,C,fe,h,pe,H,j,B,F,G,J,$,z,q,Q,W,K,Y,X,ge,ue,U],styles:[".title[_ngcontent-%COMP%]{margin:0 0 .8rem}.toolbar[_ngcontent-%COMP%]{display:flex;gap:.6rem;align-items:center;margin-bottom:.8rem}.search[_ngcontent-%COMP%]{width:min(520px,100%)}.table-wrap[_ngcontent-%COMP%]{border-radius:18px;overflow:hidden;border:1px solid rgba(255,255,255,.08);background:linear-gradient(180deg,#ffffff08,#ffffff05),#1018288c;-webkit-backdrop-filter:blur(12px) saturate(120%);backdrop-filter:blur(12px) saturate(120%)}[_nghost-%COMP%]     .mat-mdc-table, [_nghost-%COMP%]     .mat-mdc-paginator{background:transparent!important}table.glass-table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:.85rem 1rem}th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:2;background:#ffffff0f;color:var(--text);font-weight:700;-webkit-backdrop-filter:blur(6px) saturate(120%);backdrop-filter:blur(6px) saturate(120%);border-bottom:1px solid rgba(255,255,255,.08)}tr.row[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background:#ffffff08}tr.row[_ngcontent-%COMP%]:nth-child(2n)   td[_ngcontent-%COMP%]{background:#ffffff04}.stack[_ngcontent-%COMP%]{display:flex;flex-direction:column}.strong[_ngcontent-%COMP%]{font-weight:700}.muted[_ngcontent-%COMP%]{opacity:.8}.email-under-name[_ngcontent-%COMP%]{display:none}.actions[_ngcontent-%COMP%]{text-align:right;white-space:nowrap}.table-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:.55rem .75rem;border-top:1px solid rgba(255,255,255,.08);background:#0000001f;-webkit-backdrop-filter:blur(6px);backdrop-filter:blur(6px)}.range[_ngcontent-%COMP%]{opacity:.85;font-size:.92rem}@media (max-width: 900px){th[mat-header-cell][_ngcontent-%COMP%]:nth-child(2), td[mat-cell][_ngcontent-%COMP%]:nth-child(2){display:none}.email-under-name[_ngcontent-%COMP%]{display:block}}.table-wrap[_ngcontent-%COMP%]{background:#ffffff14;border-radius:16px;overflow:hidden;-webkit-backdrop-filter:blur(6px);backdrop-filter:blur(6px)}.loading[_ngcontent-%COMP%], .error[_ngcontent-%COMP%]{text-align:center;margin-top:2rem}.error[_ngcontent-%COMP%]{color:#f44336;display:flex;align-items:center;justify-content:center;gap:8px}.table-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem}"]})};export{Ce as AdminUsersComponent};
