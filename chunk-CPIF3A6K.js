import{a as F,c as T}from"./chunk-M4CUV4U7.js";import"./chunk-GGQ7LRWG.js";import{c as h,d as x,f as d,g as v,h as R,i as U}from"./chunk-NQP6NLRO.js";import{a as q}from"./chunk-KW7GL2KZ.js";import"./chunk-NZSQ27MY.js";import{a as B,b as w}from"./chunk-W6QHVSTW.js";import{Y as L,Z as N}from"./chunk-YSTQL2PO.js";import{e as k,h as D}from"./chunk-QJG5D5WU.js";import{$b as P,Ac as E,Bc as O,Ga as r,Ic as S,Jc as A,Ka as C,Mc as I,Nb as n,Ob as u,Pb as y,Ra as b,Rb as _,Wa as c,Yb as M,Zb as f,_b as s,ac as g,lb as p,mb as i,nb as e,zb as l}from"./chunk-HKUWCROW.js";import"./chunk-JKOY2XUY.js";var Y=a=>["/patient/chat",a],H=()=>["/patient/appointments"];function Q(a,o){if(a&1&&(i(0,"mat-card",2)(1,"div",9)(2,"h2"),n(3,"Next appointment"),e(),i(4,"span",10),n(5),s(6,"titlecase"),e()(),i(7,"p"),n(8),s(9,"date"),s(10,"date"),e(),i(11,"div",11)(12,"button",12),n(13,"Open Chat"),e(),i(14,"button",13),n(15,"Details"),e()()()),a&2){let t=l();p("@fadeUp",void 0),r(5),u(P(6,7,t.nextAppt.appointmentType)),r(3),_("",t.nextAppt.doctor.fullName," \xB7 ",g(9,9,t.nextAppt.date,"EEE, MMM d")," \xB7 ",g(10,12,t.nextAppt.date,"shortTime")),r(4),p("routerLink",f(15,Y,t.nextAppt.id)),r(2),p("routerLink",M(17,H))}}function $(a,o){a&1&&(i(0,"div",14),n(1,"No recent chats"),e())}function G(a,o){if(a&1&&(i(0,"div",17)(1,"mat-icon"),n(2,"forum"),e(),i(3,"div")(4,"strong"),n(5),e(),i(6,"div",18),n(7),e()()()),a&2){let t=o.$implicit;p("routerLink",f(3,Y,t.threadId)),r(5),u(t.doctor),r(2),y("Last message \xB7 ",t.last)}}function J(a,o){if(a&1&&(i(0,"div",15),c(1,G,8,5,"div",16),e()),a&2){let t=l();r(),p("ngForOf",t.recentChats)}}var z=class a{constructor(o){this.patientService=o}nextAppt=null;recentChats=[];ngOnInit(){this.loadNextAppointment(),this.loadRecentChats()}loadNextAppointment(){this.patientService.getAppointments().subscribe({next:o=>{console.log("Fetched appointments for dashboard:",o);let t=o.filter(m=>m.status==="CONFIRMED").sort((m,j)=>new Date(m.date).getTime()-new Date(j.date).getTime());this.nextAppt=t[0]||null}})}loadRecentChats(){this.patientService.getNotifications().subscribe({next:o=>{this.recentChats=o.filter(t=>t.type==="CHAT").map(t=>({doctor:t.title,last:new Date(t.createdAt).toLocaleString(),threadId:t.redirectUrl||"t-0"}))}})}static \u0275fac=function(t){return new(t||a)(C(q))};static \u0275cmp=b({type:a,selectors:[["app-dashboard"]],decls:23,vars:6,consts:[[1,"grid"],["class","card",4,"ngIf"],[1,"card"],[1,"qa"],["mat-stroked-button","","color","primary","routerLink","/patient/search"],["mat-stroked-button","","routerLink","/patient/appointments"],["mat-stroked-button","","routerLink","/patient/payments"],["class","empty",4,"ngIf"],["class","chats",4,"ngIf"],[1,"head"],[1,"badge"],[1,"actions"],["mat-flat-button","","color","primary",3,"routerLink"],["mat-stroked-button","",3,"routerLink"],[1,"empty"],[1,"chats"],["class","chat",3,"routerLink",4,"ngFor","ngForOf"],[1,"chat",3,"routerLink"],[1,"small"]],template:function(t,m){t&1&&(i(0,"div",0),c(1,Q,16,18,"mat-card",1),i(2,"mat-card",2)(3,"h2"),n(4,"Quick actions"),e(),i(5,"div",3)(6,"button",4)(7,"mat-icon"),n(8,"search"),e(),n(9," Find a doctor"),e(),i(10,"button",5)(11,"mat-icon"),n(12,"event"),e(),n(13," My appointments"),e(),i(14,"button",6)(15,"mat-icon"),n(16,"receipt_long"),e(),n(17," Payments"),e()()(),i(18,"mat-card",2)(19,"h2"),n(20,"Recent chats"),e(),c(21,$,2,0,"div",7)(22,J,2,1,"div",8),e()()),t&2&&(p("@stagger",void 0),r(),p("ngIf",m.nextAppt),r(),p("@fadeUp",void 0),r(16),p("@fadeUp",void 0),r(3),p("ngIf",m.recentChats.length===0),r(),p("ngIf",m.recentChats.length))},dependencies:[I,E,O,D,k,T,F,N,L,w,B,S,A],styles:[".grid[_ngcontent-%COMP%]{display:grid;gap:1rem;grid-template-columns:repeat(12,1fr)}.card[_ngcontent-%COMP%]:nth-child(1){grid-column:span 6}.card[_ngcontent-%COMP%]:nth-child(2){grid-column:span 6}.card[_ngcontent-%COMP%]:nth-child(3){grid-column:span 12}@media (max-width: 960px){.card[_ngcontent-%COMP%]{grid-column:span 12!important}}.head[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.head[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}.badge[_ngcontent-%COMP%]{margin-left:auto;background:#2a76b740;border:1px solid rgba(42,118,183,.45);padding:.15rem .5rem;border-radius:999px;font-size:.85rem}.actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-top:.75rem}.qa[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;margin-top:.5rem}.chats[_ngcontent-%COMP%]   .chat[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.5rem;border-radius:12px;border:1px solid rgba(255,255,255,.06);cursor:pointer}.small[_ngcontent-%COMP%]{color:var(--muted);font-size:.9rem}.empty[_ngcontent-%COMP%]{color:var(--muted)}"],data:{animation:[h("stagger",[v(":enter",[R(".card",[d({opacity:0,transform:"translateY(8px)"}),U(80,x("300ms ease-out",d({opacity:1,transform:"none"})))])])]),h("fadeUp",[v(":enter",[d({opacity:0,transform:"translateY(6px)"}),x("280ms ease-out",d({opacity:1,transform:"none"}))])])]}})};export{z as DashboardComponent};
