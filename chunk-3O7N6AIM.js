import{a as l}from"./chunk-6ZCLRSJ3.js";import{a as r}from"./chunk-X74WTQLY.js";import{aa as c,k as i,l as o}from"./chunk-PCHMKQLW.js";var a=class s{socket=null;SOCKET_URL=r.socketUrl;connected$=new o(!1);notification$=new i;onlineUsers=new Set;onlineUsers$=new o(new Set);connect(e,n){this.socket||(this.socket=l(this.SOCKET_URL,{auth:{userId:e,role:n}}),this.socket.on("connect",()=>{console.log("\u{1F50C} Connected:",this.socket.id),this.connected$.next(!0)}),this.socket.on("notification:new",t=>{this.notification$.next(t)}),this.socket.on("user:online",({userId:t})=>{this.onlineUsers.add(t),this.onlineUsers$.next(new Set(this.onlineUsers))}),this.socket.on("user:offline",({userId:t})=>{this.onlineUsers.delete(t),this.onlineUsers$.next(new Set(this.onlineUsers))}),this.socket.on("online:all",t=>{this.onlineUsers=new Set(t),this.onlineUsers$.next(new Set(this.onlineUsers)),console.log("onlineUsers$",this.onlineUsers$)}),this.socket.on("disconnect",t=>{console.warn("\u26A0\uFE0F Socket disconnected:",t),this.connected$.next(!1)}))}on(e,n){this.socket?.on(e,n)}once(e,n){this.socket?.once(e,n)}emit(e,n){this.socket?.emit(e,n)}disconnect(){this.socket?.disconnect(),this.socket=null,this.connected$.next(!1)}getSocketId(){return this.socket?.id}isOnline(e){return this.onlineUsers.has(e)}static \u0275fac=function(n){return new(n||s)};static \u0275prov=c({token:s,factory:s.\u0275fac,providedIn:"root"})};export{a};
