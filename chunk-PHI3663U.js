import{a as u,b as m}from"./chunk-43CXEHYE.js";import{$ as d,E as r,Xc as g,Y as n,Yc as b,a as o,ea as h,l,q as i,t as p}from"./chunk-WZIMFKHB.js";var c=class a{http=h(b);auth=h(m);baseUrl=u.apiBaseUrl;unreadCountSubject=new l(0);unreadCount$=this.unreadCountSubject.asObservable();getOptions(t={}){if(u.production)return o({withCredentials:!0},t);{let e=this.auth.getToken();if(!e)throw new Error("Admin session expired.");let s=new g({Authorization:`Bearer ${e}`});return o({headers:s},t)}}registerDoctor(t){return this.http.post(`${this.baseUrl}/auth/register-doctor`,t,this.getOptions()).pipe(r(e=>this.handleError(e)))}getAllUsers(){return this.http.get(`${this.baseUrl}/admin/users`,this.getOptions()).pipe(n(t=>{}),r(t=>this.handleError(t)))}toggleBan(t){return this.http.post(`${this.baseUrl}/admin/toggle-ban`,{email:t},this.getOptions()).pipe(r(e=>this.handleError(e)))}getDepartments(){return this.http.get(`${this.baseUrl}/departments`,this.getOptions()).pipe(r(t=>this.handleError(t)))}addDepartment(t){return this.http.post(`${this.baseUrl}/admin/departments`,t,this.getOptions()).pipe(r(e=>this.handleError(e)))}updateDepartment(t,e){return this.http.put(`${this.baseUrl}/admin/departments/${t}`,e,this.getOptions()).pipe(r(s=>this.handleError(s)))}deleteDepartment(t){return this.http.delete(`${this.baseUrl}/admin/departments/${t}`,this.getOptions()).pipe(r(e=>this.handleError(e)))}getDoctorUpdateRequests(){return this.http.get(`${this.baseUrl}/admin/doctor-update-requests`,this.getOptions()).pipe(n(t=>{}),r(t=>this.handleError(t)))}acceptRequest(t){return this.http.post(`${this.baseUrl}/admin/doctor-requests/${t}/accept`,{},this.getOptions()).pipe(r(e=>this.handleError(e)))}rejectRequest(t,e){return this.http.post(`${this.baseUrl}/admin/doctor-requests/${t}/reject`,{note:e},this.getOptions()).pipe(r(s=>this.handleError(s)))}deleteRequest(t){return this.http.delete(`${this.baseUrl}/admin/doctor-requests/${t}`,this.getOptions()).pipe(r(e=>this.handleError(e)))}getNotifications(){return this.http.get(`${this.baseUrl}/notifications`,this.getOptions()).pipe(n(t=>{}),p(t=>t.notifications||[]),r(t=>{let e="Failed to load notifications";return t?.error?.message&&(e=t.error.message),i(()=>new Error(e))}))}markNotificationRead(t){return this.http.patch(`${this.baseUrl}/notifications/${t}/read`,{},this.getOptions())}markallNotificationRead(){return this.http.patch(`${this.baseUrl}/notifications/readAll`,{},this.getOptions())}markNotificationUnRead(t){return this.http.patch(`${this.baseUrl}/notifications/${t}/unread`,{},this.getOptions())}deleteNotification(t){return this.http.delete(`${this.baseUrl}/notifications/${t}`,this.getOptions())}updateUnreadCount(t){this.unreadCountSubject.next(t)}decrementUnreadCount(){this.unreadCountSubject.next(Math.max(0,this.unreadCountSubject.value-1))}incrementUnreadCount(){this.unreadCountSubject.next(this.unreadCountSubject.value+1)}getDoctorById(t){return this.http.get(`${this.baseUrl}/admin/doctor/${t}`,this.getOptions())}getTransactions(){return this.http.get(`${this.baseUrl}/transactions`,this.getOptions()).pipe(p(t=>t),r(t=>i(()=>t)))}handleError(t){let e="Something went wrong. Please try again later.",s=t.error;return s?typeof s=="string"?e=s:typeof s=="object"&&(e=s.message??s.error??e):t.message&&(e=t.message),i(()=>new Error(e))}getCurrentUserFromCookie(){return this.http.get(`${this.baseUrl}/auth/me`,this.getOptions()).pipe(r(t=>i(()=>"Not authenticated")))}static \u0275fac=function(e){return new(e||a)};static \u0275prov=d({token:a,factory:a.\u0275fac,providedIn:"root"})};export{c as a};
