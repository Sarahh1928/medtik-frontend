import{a as Ue,b as Ke}from"./chunk-2HFBLQUP.js";import{a as Fe,b as Ne,c as Be,d as je}from"./chunk-EVHN6P4N.js";import{a as ze,b as Q,c as Le,d as Ve,e as Z,f as ee,g as te,h as j}from"./chunk-DRY4SCIA.js";import{a as ke,b as Te,c as Ae}from"./chunk-QWICSUZR.js";import"./chunk-F5X5MWHG.js";import{a as De,b as Ie}from"./chunk-ICQA4PUC.js";import{a as Oe,b as Se}from"./chunk-HFQD2M5G.js";import"./chunk-3GWAQ66N.js";import"./chunk-3RK6DDJD.js";import{a as W,h as H,i as J,m as X,n as Y}from"./chunk-WLFKFW6S.js";import{a as Re}from"./chunk-2T3LKAHM.js";import"./chunk-FGBTXBWS.js";import"./chunk-FMDUD5PD.js";import"./chunk-A7RO7YMV.js";import{a as N,b as B}from"./chunk-4P6M4J7Y.js";import{h as ue}from"./chunk-LC7HZC43.js";import{e as fe}from"./chunk-YXOZBBHG.js";import{A as G,b as _e,f as ve,g as Ce,h as be,j as w,l as Me,o as he,r as xe,s as ye,t as we,u as Pe}from"./chunk-CCREW7CN.js";import"./chunk-WSZ2ZTRK.js";import{T as Ee,Y as A,Z as F}from"./chunk-WXJKX6WL.js";import{$b as p,Ac as ce,Cc as me,Dc as q,Fb as ae,Hc as se,Nb as s,Ob as i,Pb as t,Qb as y,Ub as le,Vb as de,Xa as R,Xb as U,Ya as re,Zb as f,_a as d,a as V,b as oe,db as E,e as b,ed as $,fa as S,fd as pe,gd as k,jc as I,kb as D,la as M,lc as K,ma as h,nc as r,oc as C,od as ge,pb as x,pc as O,rd as T,wa as P}from"./chunk-PCHMKQLW.js";function Ge(a,o){a&1&&(i(0,"div",19),y(1,"mat-spinner",20),i(2,"p"),r(3,"Loading records..."),t()())}function We(a,o){if(a&1&&y(0,"img",35),a&2){let n=p().$implicit;s("src",n.thumb,R)}}function He(a,o){a&1&&(i(0,"mat-icon"),r(1,"picture_as_pdf"),t())}function Je(a,o){a&1&&(i(0,"mat-icon"),r(1,"insert_drive_file"),t())}function Xe(a,o){if(a&1&&(le(0),x(1,He,2,0,"mat-icon",24)(2,Je,2,0,"mat-icon",24),de()),a&2){let n=p().$implicit,e=p();d(),s("ngIf",e.isPDF(n.mime)),d(),s("ngIf",!e.isPDF(n.mime))}}function Ye(a,o){if(a&1&&(i(0,"div",36),r(1),t()),a&2){let n=p().$implicit;d(),C(n.notes)}}function Qe(a,o){if(a&1){let n=U();i(0,"div",21),f("click",function(){let l=M(n).$implicit,c=p();return h(c.preview(l))}),i(1,"div",22),x(2,We,1,1,"img",23)(3,Xe,3,2,"ng-container",24),i(4,"span",25),r(5),t()(),i(6,"div",26)(7,"div",27),r(8),t(),i(9,"div",28)(10,"span"),r(11),t(),i(12,"span",29),r(13,"\u2022"),t(),i(14,"span"),r(15),t()(),x(16,Ye,2,1,"div",30),t(),i(17,"div",31),f("click",function(l){return M(n),h(l.stopPropagation())}),i(18,"button",32)(19,"mat-icon"),r(20,"more_horiz"),t()(),i(21,"mat-menu",null,0)(23,"button",33),f("click",function(){let l=M(n).$implicit,c=p();return h(c.preview(l))}),i(24,"mat-icon"),r(25,"visibility"),t(),i(26,"span"),r(27,"Preview"),t()(),i(28,"button",33),f("click",function(){let l=M(n).$implicit,c=p();return h(c.download(l))}),i(29,"mat-icon"),r(30,"download"),t(),i(31,"span"),r(32,"Download"),t()(),i(33,"button",33),f("click",function(){let l=M(n).$implicit,c=p();return h(c.openEdit(l))}),i(34,"mat-icon"),r(35,"edit"),t(),i(36,"span"),r(37,"Edit"),t()(),i(38,"button",34),f("click",function(){let l=M(n).$implicit,c=p();return h(c.delete(l))}),i(39,"mat-icon"),r(40,"delete"),t(),i(41,"span"),r(42,"Delete"),t()()()()()}if(a&2){let n=o.$implicit,e=I(22),l=p();d(),K("is-img",!!n.thumb)("is-pdf",l.isPDF(n.mime)),d(),s("ngIf",n.thumb),d(),s("ngIf",!n.thumb),d(),s("ngClass",l.pillClass(n.type)),d(),C(n.type),d(3),C(n.name),d(3),C(l.dateLabel(n.createdAt)),d(4),O("",n.sizeKB," KB"),d(),s("ngIf",n.notes),d(2),s("matMenuTriggerFor",e)}}function Ze(a,o){if(a&1){let n=U();i(0,"div",37)(1,"mat-icon"),r(2,"inbox"),t(),i(3,"div"),r(4,"No records found"),t(),i(5,"button",38),f("click",function(){M(n);let l=p();return h(l.openAdd())}),i(6,"mat-icon"),r(7,"add"),t(),r(8," Add your first record"),t()()}}function et(a,o){if(a&1&&(i(0,"div",20),r(1),t()),a&2){let n=p();d(),C(n.fileName())}}function tt(a,o){a&1&&(i(0,"div",21),r(1,"File is required."),t())}function nt(a,o){if(a&1&&(i(0,"div",13),y(1,"img",14),t()),a&2){let n=p();d(),s("src",n.data.record.url,R)}}function it(a,o){if(a&1&&(i(0,"div",16),y(1,"iframe",17),t()),a&2){let n=p(2);d(),s("src",n.safeUrl,re)}}function ot(a,o){if(a&1&&x(0,it,2,1,"div",15),a&2){let n=p(),e=I(24);s("ngIf",n.isPDF())("ngIfElse",e)}}function rt(a,o){a&1&&(i(0,"div",18)(1,"mat-icon"),r(2,"insert_drive_file"),t(),i(3,"div"),r(4,"No inline preview. Use download."),t()())}var at=a=>new Date(a).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit"});function lt(){return b(this,null,function*(){let a=window;if(a.pdfjsLib)return a.pdfjsLib;yield new Promise((n,e)=>{let l=document.createElement("script");l.src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.min.js",l.async=!0,l.onload=()=>n(),l.onerror=()=>e(new Error("Failed to load pdf.js")),document.head.appendChild(l)});let o=window.pdfjsLib;return o.GlobalWorkerOptions.workerSrc="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.worker.min.js",o})}function ne(a,o=640,n=420){return b(this,null,function*(){try{let e=yield lt(),l=yield a.arrayBuffer(),m=yield(yield e.getDocument({data:l}).promise).getPage(1),g=m.getViewport({scale:1}),u=Math.min(o/g.width,n/g.height,2),v=m.getViewport({scale:u>0?u:1}),_=document.createElement("canvas");_.width=Math.floor(v.width),_.height=Math.floor(v.height);let L=_.getContext("2d");return yield m.render({canvasContext:L,viewport:v}).promise,_.toDataURL("image/png")}catch(e){return console.warn("PDF thumbnail generation failed:",e),null}})}function qe(a){return a.startsWith("image/")?"imaging":a==="application/pdf"?"report":"other"}var $e=class a{dialog=S(Le);snack=S(Oe);patientService=S(Re);loading=P(!0);all=P([]);constructor(){this.loadRecords()}loadRecords(){this.all.set([]),this.patientService.getRecords().subscribe({next:o=>b(this,null,function*(){let n=yield Promise.all(o.map(e=>b(this,null,function*(){let l=e.fileUrl,c=l.split("/").pop()||"Record",m=l.endsWith(".pdf"),g=null;if(m)try{let v=yield(yield fetch(l)).blob(),_=new File([v],c,{type:"application/pdf"});g=yield ne(_)}catch(u){console.warn("PDF thumbnail generation failed",u)}else l.match(/\.(png|jpg|jpeg|gif)$/i)&&(g=l);return{id:e.id.toString(),name:c,type:qe(m?"application/pdf":"application/octet-stream"),createdAt:e.createdAt,sizeKB:0,notes:e.notes||"",url:l,mime:m?"application/pdf":"application/octet-stream",thumb:g}})));this.loading.set(!1),this.all.set(n)}),error:o=>{this.loading.set(!1),console.error("Failed to load records",o),this.snack.open("Failed to load records","OK",{duration:2e3})}})}trackById(o,n){return n.id}query=P("");filter=P("all");filtered=se(()=>{let o=this.query().trim().toLowerCase(),n=this.filter();return this.all().filter(e=>n==="all"?!0:e.type===n).filter(e=>o?e.name.toLowerCase().includes(o)||(e.notes??"").toLowerCase().includes(o)||e.type.toLowerCase().includes(o):!0).sort((e,l)=>new Date(l.createdAt).getTime()-new Date(e.createdAt).getTime())});openAdd(){this.dialog.open(z,{panelClass:"medtik-dialog",data:{mode:"add"},width:"min(92vw, 700px)"}).afterClosed().subscribe(n=>b(this,null,function*(){if(!n)return;if(!n.file){this.snack.open("File is required.","OK",{duration:1400});return}let e=n.file,l=n.type||qe(e.type),c=n.notes;this.patientService.uploadMedicalRecord(e,l,c).subscribe({next:m=>b(this,null,function*(){let g=null;e.type.startsWith("image/")?g=m.fileUrl:e.type==="application/pdf"&&(g=yield ne(e));let u={id:m.id.toString(),name:e.name,type:l,createdAt:m.createdAt,sizeKB:Math.max(1,Math.round(e.size/1024)),notes:c??"",url:m.fileUrl,mime:e.type,thumb:g};this.all.update(v=>[u,...v]),this.snack.open("Record uploaded","OK",{duration:1400})}),error:m=>{console.error(m),this.snack.open("Failed to upload record","OK",{duration:2e3})}})}))}openEdit(o){this.dialog.open(z,{panelClass:"medtik-dialog",data:{mode:"edit",record:V({},o)},width:"min(92vw, 700px)"}).afterClosed().subscribe(e=>b(this,null,function*(){if(!e)return;let l=this.all().slice(),c=l.findIndex(L=>L.id===o.id);if(c<0)return;let m=l[c],g=m.url,u=m.mime,v=m.sizeKB,_=m.thumb;if(e.file){try{m.url.startsWith("blob:")&&URL.revokeObjectURL(m.url)}catch{}g=URL.createObjectURL(e.file),u=e.file.type||m.mime,v=Math.max(1,Math.round(e.file.size/1024)),u.startsWith("image/")?_=g:u==="application/pdf"?_=yield ne(e.file):_=null}l[c]=oe(V({},m),{name:(e.name||m.name).trim(),type:e.type||m.type,notes:(e.notes||"").trim(),createdAt:e.date?new Date(e.date).toISOString():m.createdAt,url:g,mime:u,sizeKB:v,thumb:_}),this.all.set(l),this.snack.open("Record updated","OK",{duration:1200})}))}preview(o){this.dialog.open(ie,{panelClass:"medtik-dialog",data:{record:o},width:"min(92vw, 900px)",maxHeight:"90vh"})}download(o){let n=document.createElement("a");n.href=o.url,n.download=o.name||"record",n.click()}delete(o){if(confirm(`Delete "${o.name}"?`)){this.patientService.deleteRecord(Number(o.id)).subscribe({next:()=>{this.all.update(n=>n.filter(e=>e.id!==o.id))}});try{o.url.startsWith("blob:")&&URL.revokeObjectURL(o.url)}catch{}this.snack.open("Record deleted","OK",{duration:1200})}}pillClass(o){return{report:o==="report",prescription:o==="prescription",lab:o==="lab",imaging:o==="imaging",other:o==="other"}}dateLabel(o){return at(o)}isPDF(o){return o==="application/pdf"}isImage(o){return o.startsWith("image/")}static \u0275fac=function(n){return new(n||a)};static \u0275cmp=D({type:a,selectors:[["app-records"]],decls:45,vars:6,consts:[["m","matMenu"],[1,"rec-wrap"],[1,"toolbar"],[1,"title"],[1,"controls"],["appearance","outline",1,"search"],["matInput","","placeholder","Title, notes, type...",3,"input","value"],["aria-label","Filter by type",1,"filters",3,"change","value"],["value","all"],["value","report"],["value","prescription"],["value","lab"],["value","imaging"],["value","other"],["mat-flat-button","","color","primary",1,"add",3,"click"],[1,"grid"],["class","loading-overlay",4,"ngIf"],["class","card","matTooltip","Click to preview",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],["class","empty",4,"ngIf"],[1,"loading-overlay"],["diameter","50"],["matTooltip","Click to preview",1,"card",3,"click"],[1,"thumb"],["alt","",3,"src",4,"ngIf"],[4,"ngIf"],[1,"pill","type",3,"ngClass"],[1,"info"],[1,"name"],[1,"meta"],[1,"dot"],["class","notes",4,"ngIf"],[1,"actions",3,"click"],["mat-icon-button","","matTooltip","More",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"warn",3,"click"],["alt","",3,"src"],[1,"notes"],[1,"empty"],["mat-stroked-button","",3,"click"]],template:function(n,e){n&1&&(i(0,"div",1)(1,"div",2)(2,"div",3)(3,"mat-icon"),r(4,"folder_shared"),t(),i(5,"h2"),r(6,"Medical records"),t()(),i(7,"div",4)(8,"mat-form-field",5)(9,"mat-label"),r(10,"Search records"),t(),i(11,"input",6),f("input",function(c){return e.query.set(c.target.value)}),t()(),i(12,"mat-button-toggle-group",7),f("change",function(c){return e.filter.set(c.value)}),i(13,"mat-button-toggle",8)(14,"mat-icon"),r(15,"all_inclusive"),t(),r(16," All"),t(),i(17,"mat-button-toggle",9)(18,"mat-icon"),r(19,"description"),t(),r(20," Reports"),t(),i(21,"mat-button-toggle",10)(22,"mat-icon"),r(23,"medical_services"),t(),r(24," Prescriptions"),t(),i(25,"mat-button-toggle",11)(26,"mat-icon"),r(27,"biotech"),t(),r(28," Labs"),t(),i(29,"mat-button-toggle",12)(30,"mat-icon"),r(31,"image"),t(),r(32," Imaging"),t(),i(33,"mat-button-toggle",13)(34,"mat-icon"),r(35,"insert_drive_file"),t(),r(36," Other"),t()(),i(37,"button",14),f("click",function(){return e.openAdd()}),i(38,"mat-icon"),r(39,"add"),t(),r(40," Add record "),t()()(),i(41,"div",15),x(42,Ge,4,0,"div",16)(43,Qe,43,13,"div",17)(44,Ze,9,0,"div",18),t()()),n&2&&(d(11),s("value",e.query()),d(),s("value",e.filter()),d(30),s("ngIf",e.loading()),d(),s("ngForOf",e.filtered())("ngForTrackBy",e.trackById),d(),s("ngIf",!e.filtered().length))},dependencies:[T,$,pe,k,ue,G,B,N,F,A,Ee,Ae,ke,Te,J,H,W,Y,X,Ie,De,je,Ne,Fe,Be,j,Se,Ke,Ue],styles:[".rec-wrap[_ngcontent-%COMP%]{padding:1rem}.toolbar[_ngcontent-%COMP%]{display:grid;gap:.75rem;margin-bottom:.75rem}.toolbar[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.6rem}.toolbar[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-weight:800;letter-spacing:.2px}.toolbar[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;justify-content:center;gap:.6rem}.toolbar[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{flex:1 1 860px;max-width:860px;min-width:min(100%,860px);margin:0 auto}.toolbar[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]{border-radius:999px;overflow:hidden;white-space:nowrap}.toolbar[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{border-radius:12px}.grid[_ngcontent-%COMP%]{display:grid;gap:1rem;grid-template-columns:repeat(3,minmax(0,1fr))}@media (max-width: 1200px){.grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(0,1fr))}}@media (max-width: 720px){.grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.card[_ngcontent-%COMP%]{background:#ffffff05;border:1px solid rgba(255,255,255,.06);border-radius:16px;box-shadow:0 10px 25px #00000040;padding:.85rem;position:relative;cursor:pointer;transition:transform .12s ease,background .12s ease,border-color .12s ease}.card[_ngcontent-%COMP%]:hover{transform:translateY(-1px);background:#ffffff0a}.card[_ngcontent-%COMP%]   .thumb[_ngcontent-%COMP%]{height:160px;border-radius:12px;border:1px dashed rgba(255,255,255,.1);background:#ffffff08;display:grid;place-items:center;overflow:hidden;position:relative}.card[_ngcontent-%COMP%]   .thumb.is-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.card[_ngcontent-%COMP%]   .thumb[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:46px;width:46px;height:46px;opacity:.85}.card[_ngcontent-%COMP%]   .thumb[_ngcontent-%COMP%]   .type[_ngcontent-%COMP%]{position:absolute;top:.5rem;left:.5rem;font-size:.75rem;padding:.15rem .5rem;border-radius:999px;border:1px solid rgba(255,255,255,.1);background:#ffffff0f}.card[_ngcontent-%COMP%]   .thumb[_ngcontent-%COMP%]   .type.report[_ngcontent-%COMP%]{border-color:#5591ff80;background:#5591ff1a}.card[_ngcontent-%COMP%]   .thumb[_ngcontent-%COMP%]   .type.prescription[_ngcontent-%COMP%]{border-color:#00c89b80;background:#00c89b1a}.card[_ngcontent-%COMP%]   .thumb[_ngcontent-%COMP%]   .type.lab[_ngcontent-%COMP%]{border-color:#ffcd3c80;background:#ffcd3c1a}.card[_ngcontent-%COMP%]   .thumb[_ngcontent-%COMP%]   .type.imaging[_ngcontent-%COMP%]{border-color:#b78cff80;background:#b78cff1a}.card[_ngcontent-%COMP%]   .thumb[_ngcontent-%COMP%]   .type.other[_ngcontent-%COMP%]{border-color:#fff3;background:#ffffff14}.card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{padding-top:.6rem}.card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:700}.card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{opacity:.85;display:flex;gap:.4rem;align-items:center}.card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]{opacity:.5}.card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]{opacity:.85;margin-top:.25rem}.card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{position:absolute;top:.35rem;right:.25rem}.empty[_ngcontent-%COMP%]{grid-column:1/-1;border:1px dashed rgba(255,255,255,.12);border-radius:16px;padding:2rem;text-align:center;display:grid;gap:.5rem;place-items:center}.empty[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:36px;width:36px;height:36px;opacity:.85}.loading-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#00000080;z-index:10;border-radius:12px;color:#fff;gap:.5rem}.rec-wrap[_ngcontent-%COMP%]{position:relative}"]})},z=class a{constructor(o,n){this.dialogRef=o;this.data=n;this.form=new be({name:new w("",{nonNullable:!0}),type:new w("report",{nonNullable:!0}),date:new w(null),notes:new w("",{nonNullable:!0}),file:new w(null)});let e=n.record;e&&this.form.patchValue({name:e.name,type:e.type,date:e.createdAt.slice(0,10),notes:e.notes??""})}form;fileRequired(){return this.data.mode==="add"}fileName(){return this.form.controls.file.value?.name??""}onFile(o){let e=o.target?.files?.[0]??null;this.form.controls.file.setValue(e),e&&!this.form.controls.name.value&&this.form.controls.name.setValue(e.name.replace(/\.[^.]+$/,""))}close(){this.dialogRef.close()}save(){if(this.fileRequired()&&!this.form.controls.file.value)return;let o=this.form.getRawValue(),n={name:o.name,type:o.type,date:o.date,notes:o.notes,file:o.file};this.dialogRef.close(n)}static \u0275fac=function(n){return new(n||a)(E(ze),E(Q))};static \u0275cmp=D({type:a,selectors:[["app-add-edit-record-dialog"]],decls:45,vars:8,consts:[["mat-dialog-title",""],[1,"dlg-form",3,"formGroup"],["appearance","outline",1,"field"],["matInput","","formControlName","name","placeholder","e.g., CBC Result"],["matNativeControl","","formControlName","type"],["value","report"],["value","prescription"],["value","lab"],["value","imaging"],["value","other"],["matInput","","type","date","formControlName","date"],["appearance","outline",1,"field","full"],["matInput","","rows","3","formControlName","notes"],[1,"uploader"],["type","file",3,"change"],["class","file-name",4,"ngIf"],["class","hint",4,"ngIf"],["align","end"],["mat-button","",3,"click"],["mat-flat-button","","color","primary",3,"click"],[1,"file-name"],[1,"hint"]],template:function(n,e){n&1&&(i(0,"h2",0)(1,"mat-icon"),r(2),t(),r(3),t(),i(4,"mat-dialog-content")(5,"form",1)(6,"mat-form-field",2)(7,"mat-label"),r(8,"Title"),t(),y(9,"input",3),t(),i(10,"mat-form-field",2)(11,"mat-label"),r(12,"Type"),t(),i(13,"select",4)(14,"option",5),r(15,"Report"),t(),i(16,"option",6),r(17,"Prescription"),t(),i(18,"option",7),r(19,"Lab"),t(),i(20,"option",8),r(21,"Imaging"),t(),i(22,"option",9),r(23,"Other"),t()()(),i(24,"mat-form-field",2)(25,"mat-label"),r(26,"Date"),t(),y(27,"input",10),t(),i(28,"mat-form-field",11)(29,"mat-label"),r(30,"Notes"),t(),y(31,"textarea",12),t(),i(32,"div",13)(33,"mat-icon"),r(34,"attach_file"),t(),i(35,"label"),r(36),i(37,"input",14),f("change",function(c){return e.onFile(c)}),t()(),x(38,et,2,1,"div",15)(39,tt,2,0,"div",16),t()()(),i(40,"mat-dialog-actions",17)(41,"button",18),f("click",function(){return e.close()}),r(42,"Cancel"),t(),i(43,"button",19),f("click",function(){return e.save()}),r(44,"Save"),t()()),n&2&&(d(2),C(e.data.mode==="add"?"upload_file":"edit"),d(),O(" ",e.data.mode==="add"?"Add record":"Edit record"," "),d(2),s("formGroup",e.form),d(27),K("error",e.fileRequired()&&!e.form.controls.file.value),d(4),O(" ",e.data.mode==="add"?"Choose a file":"Replace file (optional)"," "),d(2),s("ngIf",e.fileName()),d(),s("ngIf",e.fileRequired()&&!e.form.controls.file.value))},dependencies:[T,k,G,Me,we,Pe,_e,ye,ve,Ce,he,xe,j,Z,te,ee,B,N,F,A,J,H,W,Y,X],styles:[".dlg-form[_ngcontent-%COMP%]{display:grid;gap:.75rem;grid-template-columns:1fr 1fr}.field.full[_ngcontent-%COMP%]{grid-column:1/-1}.uploader[_ngcontent-%COMP%]{grid-column:1/-1;display:flex;align-items:center;gap:.6rem;border:1px dashed rgba(255,255,255,.15);padding:.75rem;border-radius:12px}.uploader.error[_ngcontent-%COMP%]{border-color:#ff7a7a}.uploader[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{display:block;margin-top:.15rem}.file-name[_ngcontent-%COMP%]{opacity:.85;font-size:.9rem}.hint[_ngcontent-%COMP%]{color:#ff7a7a;font-size:.85rem}.mdc-text-field--outlined[_ngcontent-%COMP%]   .mdc-text-field__input[_ngcontent-%COMP%]{padding-top:12px!important;padding-bottom:12px!important;line-height:1!important}.mat-mdc-form-field[_ngcontent-%COMP%]{--mat-form-field-container-vertical-padding: 15px}"]})},ie=class a{constructor(o,n){this.data=o;this.sanitizer=n;this.safeUrl=this.sanitizer.bypassSecurityTrustResourceUrl(this.data.record.url)}safeUrl;isImage(){return this.data.record.mime.startsWith("image/")}isPDF(){return this.data.record.mime==="application/pdf"}static \u0275fac=function(n){return new(n||a)(E(Q),E(fe))};static \u0275cmp=D({type:a,selectors:[["app-record-preview-dialog"]],decls:32,vars:12,consts:[["notImg",""],["generic",""],["mat-dialog-title",""],[1,"pv"],[1,"pv-meta"],[1,"name"],[1,"sub"],[1,"pill",3,"ngClass"],[1,"dot"],["class","pv-view",4,"ngIf","ngIfElse"],["align","end"],["mat-stroked-button","",3,"href"],["mat-button","","mat-dialog-close",""],[1,"pv-view"],["alt","",3,"src"],["class","pv-view pdf",4,"ngIf","ngIfElse"],[1,"pv-view","pdf"],["width","100%","height","100%",2,"border","0",3,"src"],[1,"generic"]],template:function(n,e){if(n&1&&(i(0,"h2",2)(1,"mat-icon"),r(2,"visibility"),t(),r(3," Preview "),t(),i(4,"mat-dialog-content",3)(5,"div",4)(6,"div",5),r(7),t(),i(8,"div",6)(9,"span",7),r(10),t(),i(11,"span",8),r(12,"\u2022"),t(),i(13,"span"),r(14),t(),i(15,"span",8),r(16,"\u2022"),t(),i(17,"span"),r(18),ce(19,"date"),t()()(),x(20,nt,2,1,"div",9)(21,ot,1,2,"ng-template",null,0,q)(23,rt,5,0,"ng-template",null,1,q),t(),i(25,"mat-dialog-actions",10)(26,"a",11)(27,"mat-icon"),r(28,"download"),t(),r(29," Download "),t(),i(30,"button",12),r(31,"Close"),t()()),n&2){let l=I(22);d(7),C(e.data.record.name),d(2),s("ngClass",e.data.record.type),d(),C(e.data.record.type),d(4),O("",e.data.record.sizeKB," KB"),d(4),C(me(19,9,e.data.record.createdAt,"mediumDate")),d(2),s("ngIf",e.isImage())("ngIfElse",l),d(6),s("href",e.data.record.url,R),ae("download",e.data.record.name)}},dependencies:[T,$,k,j,Ve,Z,te,ee,B,N,F,A,ge],styles:[".pv[_ngcontent-%COMP%]{display:grid;gap:.75rem}.pv-meta[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:800;letter-spacing:.2px}.pv-meta[_ngcontent-%COMP%]   .sub[_ngcontent-%COMP%]{opacity:.85;display:flex;align-items:center;gap:.5rem;flex-wrap:wrap}.pv-meta[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]{opacity:.5}.pv-view[_ngcontent-%COMP%]{height:60vh;border:1px solid rgba(255,255,255,.08);border-radius:12px;overflow:hidden;background:#0f131b;display:grid;place-items:center}.pv-view[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:contain}.pv-view.pdf[_ngcontent-%COMP%]{background:#0f131b}.generic[_ngcontent-%COMP%]{display:grid;gap:.25rem;place-items:center;opacity:.85}"]})};export{z as AddEditRecordDialogComponent,ie as PreviewDialogComponent,$e as RecordsComponent};
