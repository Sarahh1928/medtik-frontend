import"./chunk-3RK6DDJD.js";import{a as T,b as A,h as j,i as q,m as B,n as D}from"./chunk-AK7HCWPM.js";import{A as O,b as x,d as f,f as y,g as I,l as E,o as R,r as S,y as k}from"./chunk-K2DA6FBL.js";import{Y as F,Z as N}from"./chunk-LVPX6TEL.js";import{b as P}from"./chunk-43CXEHYE.js";import{b as C,d as M}from"./chunk-L73FSOJZ.js";import{$a as p,Cb as h,Eb as c,Gc as v,La as s,Pa as l,Rc as b,Sb as n,Tb as u,Ub as w,Wa as g,Yc as _,qb as m,rb as r,sb as o,tb as d}from"./chunk-WZIMFKHB.js";function G(t,a){t&1&&(r(0,"mat-error"),n(1," Password is required "),o())}function H(t,a){t&1&&(r(0,"mat-error"),n(1," Minimum 6 characters "),o())}function z(t,a){t&1&&(r(0,"mat-error"),n(1," Confirmation is required "),o())}function U(t,a){t&1&&(r(0,"mat-error"),n(1," Passwords do not match "),o())}function J(t,a){if(t&1&&(r(0,"p",16),n(1),o()),t&2){let i=c();s(),u(i.apiError)}}function K(t,a){if(t&1&&(r(0,"p",17),n(1),o()),t&2){let i=c();s(),u(i.infoMessage)}}var L=class t{constructor(a,i,e,V,Q){this.fb=a;this.route=i;this.http=e;this.router=V;this.service=Q;this.form=this.fb.group({password:["",[f.required,f.minLength(6)]],confirmPassword:["",f.required]},{validators:this.passwordsMatch})}form;apiError="";infoMessage="";loading=!1;token="";ngOnInit(){this.token=this.route.snapshot.queryParamMap.get("token")||"",console.log("Reset token from URL:",this.token),this.token||(this.apiError="Invalid or missing token.")}passwordsMatch(a){let i=a.get("password")?.value,e=a.get("confirmPassword")?.value;return i&&e&&i!==e?{mismatch:!0}:null}submit(){if(this.form.invalid||!this.token)return;this.apiError="",this.infoMessage="",this.loading=!0;let{password:a}=this.form.value;this.service.resetPassword(this.token,a).subscribe({next:()=>{this.loading=!1,this.infoMessage="Password successfully reset. Redirecting...",setTimeout(()=>this.router.navigate(["/auth/login"]),2e3)},error:i=>{this.loading=!1,this.apiError=i.error?.message||"Reset failed. Please try again."}})}static \u0275fac=function(i){return new(i||t)(l(k),l(C),l(_),l(M),l(P))};static \u0275cmp=g({type:t,selectors:[["app-reset-password"]],decls:31,vars:9,consts:[[1,"auth-shell"],[1,"auth-frame"],[1,"form-pane","only-form"],[1,"brand"],["src","https://ik.imagekit.io/a2wpi1kd9/imgToUrl/image-to-url_HEow9eLbR","alt","Medtik",1,"brand-mark"],[1,"sub"],[3,"ngSubmit","formGroup"],["appearance","outline"],["matInput","","type","password","formControlName","password","placeholder","********"],[4,"ngIf"],["matInput","","type","password","formControlName","confirmPassword","placeholder","********"],["class","api-error","role","alert",4,"ngIf"],["class","info",4,"ngIf"],["mat-flat-button","","color","primary","type","submit",1,"submit",3,"disabled"],[1,"aux"],["routerLink","/auth/sign-in"],["role","alert",1,"api-error"],[1,"info"]],template:function(i,e){i&1&&(r(0,"div",0)(1,"div",1)(2,"main",2)(3,"div",3),d(4,"img",4),r(5,"h1"),n(6,"Reset Password"),o()(),r(7,"h2"),n(8,"Set a new password"),o(),r(9,"p",5),n(10,"Enter your new password below to complete the reset process."),o(),r(11,"form",6),h("ngSubmit",function(){return e.submit()}),r(12,"mat-form-field",7)(13,"mat-label"),n(14,"New password"),o(),d(15,"input",8),p(16,G,2,0,"mat-error",9)(17,H,2,0,"mat-error",9),o(),r(18,"mat-form-field",7)(19,"mat-label"),n(20,"Confirm password"),o(),d(21,"input",10),p(22,z,2,0,"mat-error",9)(23,U,2,0,"mat-error",9),o(),p(24,J,2,1,"p",11)(25,K,2,1,"p",12),r(26,"button",13),n(27),o(),r(28,"div",14)(29,"a",15),n(30,"Back to sign in"),o()()()()()()),i&2&&(s(11),m("formGroup",e.form),s(5),m("ngIf",e.form.controls.password.touched&&(e.form.controls.password.errors==null?null:e.form.controls.password.errors.required)),s(),m("ngIf",e.form.controls.password.errors==null?null:e.form.controls.password.errors.minlength),s(5),m("ngIf",e.form.controls.confirmPassword.touched&&(e.form.controls.confirmPassword.errors==null?null:e.form.controls.confirmPassword.errors.required)),s(),m("ngIf",e.form.errors==null?null:e.form.errors.mismatch),s(),m("ngIf",e.apiError),s(),m("ngIf",e.infoMessage),s(),m("disabled",e.loading),s(),w(" ",e.loading?"Resetting...":"Reset Password"," "))},dependencies:[b,v,O,E,x,y,I,R,S,q,j,T,A,D,B,N,F],styles:[".auth-shell[_ngcontent-%COMP%]{min-height:100svh;display:flex;align-items:center;justify-content:center;padding:clamp(16px,4vmin,32px);overflow:auto}.auth-frame[_ngcontent-%COMP%]{width:min(520px,94vw);display:grid;grid-template-columns:1fr;border-radius:24px;background:linear-gradient(180deg,#ffffff08,#ffffff05),#101828b8;-webkit-backdrop-filter:blur(10px) saturate(120%);backdrop-filter:blur(10px) saturate(120%);border:1px solid rgba(255,255,255,.08);box-shadow:0 24px 70px #00000080}.form-pane[_ngcontent-%COMP%]{padding:28px 20px;display:grid;align-content:start}.brand[_ngcontent-%COMP%]{display:grid;place-items:center;gap:.35rem;margin-bottom:.75rem;text-align:center}.brand-mark[_ngcontent-%COMP%]{width:96px;height:96px;object-fit:contain;filter:drop-shadow(0 10px 24px rgba(42,118,183,.6))}h2[_ngcontent-%COMP%]{margin:.25rem 0 .5rem;font-weight:800;color:#e6eef6;font-size:clamp(1.2rem,2vw,1.5rem)}.sub[_ngcontent-%COMP%]{margin:.1rem 0 1rem;color:#a7b4c5}form[_ngcontent-%COMP%]{display:grid;gap:.8rem}.submit[_ngcontent-%COMP%]{width:100%;border-radius:12px;margin-top:.25rem}.aux[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:.1rem}.aux[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#a7b4c5;text-decoration:none}.aux[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#e6eaf2}.api-error[_ngcontent-%COMP%]{color:#f44336;font-size:.85rem;margin:-.25rem 0 .5rem}.info[_ngcontent-%COMP%]{color:#a7b4c5;font-size:.85rem;margin:-.25rem 0 .5rem}"]})};export{L as ResetPasswordComponent};
