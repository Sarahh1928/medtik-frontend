import{a as S,b as dt,c as mt}from"./chunk-E2JTTORF.js";import{a as U,b as G,c as J,d as K,e as W,f as X,g as tt,h as et,i as at,j as it,k as nt,l as ot}from"./chunk-EU2GGAHC.js";import{a as C,b as rt}from"./chunk-UKL3BBPM.js";import{a as st}from"./chunk-KAG44AFS.js";import{a as B,d as Y}from"./chunk-LXWUKR3B.js";import"./chunk-F5X5MWHG.js";import{b as j}from"./chunk-XGLVXY7I.js";import"./chunk-ZCFZR4S3.js";import"./chunk-4K5T2QBN.js";import{a as z,e as F,h as H,i as $,m as Z,n as q}from"./chunk-LCR2LKFI.js";import"./chunk-BR5LHSVS.js";import"./chunk-OY7Y436C.js";import"./chunk-YCVTR2B7.js";import"./chunk-TR43TC6U.js";import{A as R,b as k,f as O,j as I,n as L}from"./chunk-YN6JIHUF.js";import"./chunk-JQ5JD7Q3.js";import{a as Q,b as V}from"./chunk-W6QHVSTW.js";import{Z as N}from"./chunk-YSTQL2PO.js";import{$ as b,Db as M,Eb as y,Fb as _,Ga as d,Jc as h,Mc as E,Nb as r,Ob as f,Pb as T,Ra as v,Wa as s,Xb as D,_b as x,ac as P,fc as A,lb as l,mb as o,nb as n,ob as g,sb as p,tb as c,u as w}from"./chunk-HKUWCROW.js";import"./chunk-JKOY2XUY.js";function pt(e,t){e&1&&(o(0,"th",20),r(1,"ID"),n())}function ct(e,t){if(e&1&&(o(0,"td",21),r(1),n()),e&2){let a=t.$implicit;d(),f(a.id)}}function ft(e,t){e&1&&(o(0,"th",20),r(1,"Patient"),n())}function ut(e,t){if(e&1&&(o(0,"td",21),r(1),n()),e&2){let a=t.$implicit;d(),f(a.patient)}}function gt(e,t){e&1&&(o(0,"th",20),r(1,"Doctor"),n())}function ht(e,t){if(e&1&&(o(0,"td",21),r(1),n()),e&2){let a=t.$implicit;d(),f(a.doctor)}}function Ct(e,t){e&1&&(o(0,"th",20),r(1,"Department"),n())}function St(e,t){if(e&1&&(o(0,"td",21),r(1),n()),e&2){let a=t.$implicit;d(),f(a.department)}}function Mt(e,t){e&1&&(o(0,"th",20),r(1,"Type"),n())}function yt(e,t){if(e&1&&(o(0,"td",21)(1,"mat-chip",22),r(2),n()()),e&2){let a=t.$implicit;d(),l("color",a.type==="video"?"primary":a.type==="voice"?"accent":"warn"),d(),T(" ",a.type," ")}}function _t(e,t){e&1&&(o(0,"th",20),r(1,"Date"),n())}function wt(e,t){if(e&1&&(o(0,"td",21),r(1),x(2,"date"),n()),e&2){let a=t.$implicit;d(),f(P(2,1,a.date,"MMM d, y \u2022 h:mm a"))}}function bt(e,t){e&1&&g(0,"tr",23)}function vt(e,t){e&1&&g(0,"tr",24)}var lt=class e{cols=["id","patient","doctor","department","type","date"];pageSize=10;service=b(st);filterCtrl=new I("",{nonNullable:!0});seed=[{id:"S-1010",patient:"Alice Mostafa",doctor:"Dr. Omar",department:"Cardiology",type:"video",date:"2025-01-15T09:30:00Z"},{id:"S-1009",patient:"Karim Adel",doctor:"Dr. Sara",department:"Dermatology",type:"voice",date:"2025-01-13T17:00:00Z"},{id:"S-1008",patient:"Nour Gamal",doctor:"Dr. Layla",department:"Pediatrics",type:"audio",date:"2025-01-12T11:15:00Z"},{id:"S-1007",patient:"Youssef Said",doctor:"Dr. Omar",department:"Cardiology",type:"video",date:"2025-01-10T14:45:00Z"},{id:"S-1006",patient:"Lamia Fathy",doctor:"Dr. Sara",department:"Dermatology",type:"voice",date:"2025-01-09"},{id:"S-1005",patient:"Hana Tarek",doctor:"Dr. Layla",department:"Pediatrics",type:"audio",date:"2025-01-08"},{id:"S-1004",patient:"Ahmed Samir",doctor:"Dr. Yara",department:"Neurology",type:"video",date:"2025-01-07"},{id:"S-1003",patient:"Mariam Zaki",doctor:"Dr. Yara",department:"Neurology",type:"voice",date:"2025-01-06"},{id:"S-1002",patient:"Omar Ali",doctor:"Dr. Layla",department:"Pediatrics",type:"audio",date:"2025-01-05"},{id:"S-1001",patient:"Sara Adel",doctor:"Dr. Omar",department:"Cardiology",type:"video",date:"2025-01-03"},{id:"S-1000",patient:"Mahmoud Nasser",doctor:"Dr. Sara",department:"Dermatology",type:"voice",date:"2024-12-30"}];data=new ot([]);ngAfterViewInit(){this.data.paginator=this.paginator,this.data.sort=this.sort,this.data.sortingDataAccessor=(t,a)=>{switch(a){case"id":return t.id;case"patient":return(t.patient??"").toLowerCase();case"doctor":return(t.doctor??"").toLowerCase();case"department":return(t.department??"").toLowerCase();case"type":return t.type;case"date":return new Date(t.date).getTime()||0;default:return t[a]}},setTimeout(()=>{this.sort.active="date",this.sort.direction="desc",this.sort.sortChange.emit({active:"date",direction:"desc"})}),this.data.filterPredicate=(t,a)=>{let i=a.trim().toLowerCase();return t.id.toLowerCase().includes(i)||t.patient.toLowerCase().includes(i)||t.doctor.toLowerCase().includes(i)||t.department.toLowerCase().includes(i)||t.type.toLowerCase().includes(i)},this.filterCtrl.valueChanges.subscribe(t=>{this.data.filter=(t??"").trim().toLowerCase(),this.data.paginator&&this.data.paginator.firstPage()}),this.fetchTransactions()}fetchTransactions(){w({txns:this.service.getTransactions(),depts:this.service.getDepartments()}).subscribe({next:({txns:t,depts:a})=>{console.log("Transactions:",t),console.log("Departments:",a);let i={};a.forEach(m=>i[m.id]=m.name);let u=t.map(m=>({id:m.id.toString(),patient:m.patient?.user?.fullName||"Unknown",doctor:m.doctor?.user?.fullName||"Unknown",department:i[m.doctor?.departmentId]||"N/A",type:m.appointment?.appointmentType?.toLowerCase()||"video",date:m.createdAt||m.appointment?.date||""}));this.data.data=u},error:t=>console.error("Error fetching transactions/departments:",t)})}paginator;sort;rangeLabel=A(()=>{if(!this.paginator)return"";let t=this.data.filteredData.length,a=this.paginator.pageIndex*this.paginator.pageSize,i=Math.min(a+this.paginator.pageSize,t);return t?`Showing ${a+1}\u2013${i} of ${t}`:"No results"});view(t){console.log("view session",t)}static \u0275fac=function(a){return new(a||e)};static \u0275cmp=v({type:e,selectors:[["admin-transactions"]],viewQuery:function(a,i){if(a&1&&(M(C,5),M(S,5)),a&2){let u;y(u=_())&&(i.paginator=u.first),y(u=_())&&(i.sort=u.first)}},features:[D([h])],decls:35,vars:8,consts:[[1,"title"],[1,"toolbar"],["appearance","outline",1,"search"],["matInput","","placeholder","ID, patient, doctor, department, type",3,"formControl"],["matSuffix",""],[1,"table-wrap","mat-elevation-z2"],["mat-table","","matSort","",1,"glass-table",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","patient"],["matColumnDef","doctor"],["matColumnDef","department"],["matColumnDef","type"],["matColumnDef","date"],["mat-header-row","","class","sticky",4,"matHeaderRowDef"],["mat-row","","class","row",4,"matRowDef","matRowDefColumns"],[1,"table-footer"],[1,"range"],["showFirstLastButtons","",3,"length","pageSize","hidePageSize"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[3,"color"],["mat-header-row","",1,"sticky"],["mat-row","",1,"row"]],template:function(a,i){a&1&&(o(0,"h2",0),r(1,"Sessions"),n(),o(2,"div",1)(3,"mat-form-field",2)(4,"mat-label"),r(5,"Search sessions"),n(),g(6,"input",3),o(7,"mat-icon",4),r(8,"search"),n()()(),o(9,"div",5)(10,"table",6),p(11,7),s(12,pt,2,0,"th",8)(13,ct,2,1,"td",9),c(),p(14,10),s(15,ft,2,0,"th",8)(16,ut,2,1,"td",9),c(),p(17,11),s(18,gt,2,0,"th",8)(19,ht,2,1,"td",9),c(),p(20,12),s(21,Ct,2,0,"th",8)(22,St,2,1,"td",9),c(),p(23,13),s(24,Mt,2,0,"th",8)(25,yt,3,2,"td",9),c(),p(26,14),s(27,_t,2,0,"th",8)(28,wt,3,4,"td",9),c(),s(29,bt,1,0,"tr",15)(30,vt,1,0,"tr",16),n(),o(31,"div",17)(32,"div",18),r(33),n(),g(34,"mat-paginator",19),n()()),a&2&&(d(6),l("formControl",i.filterCtrl),d(4),l("dataSource",i.data),d(19),l("matHeaderRowDef",i.cols),d(),l("matRowDefColumns",i.cols),d(3),f(i.rangeLabel()),d(),l("length",i.data.filteredData.length)("pageSize",i.pageSize)("hidePageSize",!0))},dependencies:[E,R,k,O,L,nt,U,J,tt,K,G,et,W,X,at,it,rt,C,mt,S,dt,$,H,z,F,q,Z,Y,B,V,Q,j,N,h],styles:[".title[_ngcontent-%COMP%]{margin:0 0 .8rem}.toolbar[_ngcontent-%COMP%]{display:flex;gap:.6rem;align-items:center;margin-bottom:.8rem}.search[_ngcontent-%COMP%]{width:min(520px,100%)}.table-wrap[_ngcontent-%COMP%]{border-radius:18px;overflow:hidden;border:1px solid rgba(255,255,255,.08);background:linear-gradient(180deg,#ffffff08,#ffffff05),#1018288c;-webkit-backdrop-filter:blur(12px) saturate(120%);backdrop-filter:blur(12px) saturate(120%)}[_nghost-%COMP%]     .mat-mdc-table, [_nghost-%COMP%]     .mat-mdc-paginator{background:transparent!important}table.glass-table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:.85rem 1rem}th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:2;background:#ffffff0f;color:var(--text);font-weight:700;border-bottom:1px solid rgba(255,255,255,.08);-webkit-backdrop-filter:blur(6px) saturate(120%);backdrop-filter:blur(6px) saturate(120%)}tr.row[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background:#ffffff08}tr.row[_ngcontent-%COMP%]:nth-child(2n)   td[_ngcontent-%COMP%]{background:#ffffff04}.actions[_ngcontent-%COMP%]{text-align:right;white-space:nowrap}.table-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:.55rem .75rem;border-top:1px solid rgba(255,255,255,.08);background:#0000001f;-webkit-backdrop-filter:blur(6px);backdrop-filter:blur(6px)}.range[_ngcontent-%COMP%]{opacity:.85;font-size:.92rem}"]})};export{lt as AdminTransactionsComponent};
